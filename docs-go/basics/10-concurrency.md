---
sidebar_position: 10
description: "–í —ç—Ç–æ–º —É—Ä–æ–∫–µ –º—ã –∏–∑—É—á–∏–º –≥–æ—Ä—É—Ç–∏–Ω—ã –∏ –∫–∞–Ω–∞–ª—ã, –æ—Å–Ω–æ–≤–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω–æ–≥–æ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è –≤ Go."
---

# –ö–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω–æ—Å—Ç—å: –ì–æ—Ä—É—Ç–∏–Ω—ã –∏ –∫–∞–Ω–∞–ª—ã

–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –æ–¥–∏–Ω –∏–∑ —Å–∞–º—ã—Ö —Å–ª–æ–∂–Ω—ã—Ö —É—Ä–æ–∫–æ–≤! –ö–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω–æ—Å—Ç—å ‚Äî —ç—Ç–æ —Ç–æ, —Ä–∞–¥–∏ —á–µ–≥–æ –º–Ω–æ–≥–∏–µ –≤—ã–±–∏—Ä–∞—é—Ç Go. –Ø–∑—ã–∫ —Å–æ–∑–¥–∞–Ω –¥–ª—è –ø—Ä–æ—Å—Ç–æ–≥–æ –∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–≥–æ –ø–∞—Ä–∞–ª–ª–µ–ª–∏–∑–º–∞.

–ì–ª–∞–≤–Ω—ã–π —Å–ª–æ–≥–∞–Ω Go:  
**¬´–ù–µ –æ–±—â–∞–π—Ç–µ—Å—å —á–µ—Ä–µ–∑ –æ–±—â—É—é –ø–∞–º—è—Ç—å ‚Äî –¥–µ–ª–∏—Ç–µ—Å—å –ø–∞–º—è—Ç—å—é —á–µ—Ä–µ–∑ –æ–±—â–µ–Ω–∏–µ¬ª**  (—Ç–æ –µ—Å—Ç—å –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–∞–Ω–∞–ª—ã, –∞ –Ω–µ –º—å—é—Ç–µ–∫—Å—ã).

## –ì–æ—Ä—É—Ç–∏–Ω—ã (goroutines)

**–ì–æ—Ä—É—Ç–∏–Ω–∞** –≤ Go ‚Äî —ç—Ç–æ –ª—ë–≥–∫–∞—è "–Ω–∏—Ç—å" –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∫–æ–¥–∞, –∫–æ—Ç–æ—Ä—É—é —è–∑—ã–∫ —É–º–µ–µ—Ç –∑–∞–ø—É—Å–∫–∞—Ç—å —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ –∏ –æ—á–µ–Ω—å –¥—ë—à–µ–≤–æ (—Ç—ã—Å—è—á–∏ –≥–æ—Ä—É—Ç–∏–Ω –∑–∞–Ω–∏–º–∞—é—Ç –≤—Å–µ–≥–æ –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–µ–≥–∞–±–∞–π—Ç –ø–∞–º—è—Ç–∏). –¢—ã –ø—Ä–æ—Å—Ç–æ –ø–∏—à–µ—à—å `go funcName()` –∏–ª–∏ `go func() { ... }()`, –∏ —ç—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è –Ω–∞—á–∏–Ω–∞–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å **–ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ** —Å –æ—Å—Ç–∞–ª—å–Ω—ã–º –∫–æ–¥–æ–º, –Ω–µ –±–ª–æ–∫–∏—Ä—É—è –æ—Å–Ω–æ–≤–Ω–æ–π –ø–æ—Ç–æ–∫.

–ì–æ—Ä—É—Ç–∏–Ω—ã –Ω—É–∂–Ω—ã, —á—Ç–æ–±—ã –ø—Ä–æ–≥—Ä–∞–º–º–∞ –º–æ–≥–ª–∞ –¥–µ–ª–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –¥–µ–ª –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ: –Ω–∞–ø—Ä–∏–º–µ—Ä, –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å —Ç—ã—Å—è—á–∏ HTTP-–∑–∞–ø—Ä–æ—Å–æ–≤ —Å—Ä–∞–∑—É, —á–∏—Ç–∞—Ç—å –∏–∑ –±–∞–∑—ã, –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å email –∏ —Å—á–∏—Ç–∞—Ç—å —á—Ç–æ-—Ç–æ —Ç—è–∂—ë–ª–æ–µ ‚Äî –≤—Å—ë —ç—Ç–æ –±–µ–∑ –∑–∞–¥–µ—Ä–∂–µ–∫ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π. –ë–µ–∑ –≥–æ—Ä—É—Ç–∏–Ω –æ–¥–∏–Ω –¥–æ–ª–≥–∏–π –∑–∞–ø—Ä–æ—Å "–∑–∞–º–æ—Ä–∞–∂–∏–≤–∞–ª" –±—ã –≤–µ—Å—å —Å–µ—Ä–≤–µ—Ä, –∞ —Å –Ω–∏–º–∏ Go –ª–µ–≥–∫–æ —Å–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —Å –≤—ã—Å–æ–∫–æ–π –Ω–∞–≥—Ä—É–∑–∫–æ–π, –æ—Å—Ç–∞–≤–∞—è—Å—å –ø—Ä–æ—Å—Ç—ã–º –∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–º. 

> <br /> –ì–æ—Ä—É—Ç–∏–Ω—ã ‚Äî —ç—Ç–æ —Å—É–ø–µ—Ä–ª—ë–≥–∫–∏–π –∏ —É–¥–æ–±–Ω—ã–π —Å–ø–æ—Å–æ–± –¥–µ–ª–∞—Ç—å –≤–µ—â–∏ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ, –±–ª–∞–≥–æ–¥–∞—Ä—è –∫–æ—Ç–æ—Ä–æ–º—É Go —Ç–∞–∫ –ª—é–±—è—Ç –¥–ª—è –≤–µ–±-—Å–µ—Ä–≤–∏—Å–æ–≤ –∏ –≤—ã—Å–æ–∫–æ–Ω–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö —Å–∏—Å—Ç–µ–º. 

```go
go func() {
    fmt.Println("–Ø —Ä–∞–±–æ—Ç–∞—é –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ!")
}()
```

–ì–æ—Ä—É—Ç–∏–Ω—ã –æ—á–µ–Ω—å –¥–µ—à—ë–≤—ã–µ: —Ç—ã—Å—è—á–∏ –∏ –¥–∞–∂–µ –º–∏–ª–ª–∏–æ–Ω—ã ‚Äî –±–µ–∑ –ø—Ä–æ–±–ª–µ–º.

### –ü—Ä–æ—Å—Ç–æ–π –ø—Ä–∏–º–µ—Ä

```go
package main

import (
    "fmt"
    "time"
)

func worker(id int) {
    fmt.Printf("–í–æ—Ä–∫–µ—Ä %d —Å—Ç–∞—Ä—Ç–æ–≤–∞–ª\n", id)
    time.Sleep(time.Second * time.Duration(id))
    fmt.Printf("–í–æ—Ä–∫–µ—Ä %d –∑–∞–≤–µ—Ä—à—ë–Ω\n", id)
}

func main() {
    for i := 1; i <= 5; i++ {
        go worker(i) // –ó–∞–ø—É—Å–∫–∞–µ–º –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ
    }

    fmt.Println("–í—Å–µ –≤–æ—Ä–∫–µ—Ä—ã –∑–∞–ø—É—â–µ–Ω—ã")
    time.Sleep(6 * time.Second) // –î–∞—ë–º –∏–º –∑–∞–≤–µ—Ä—à–∏—Ç—å—Å—è
    fmt.Println("–ì–ª–∞–≤–Ω–∞—è –≥–æ—Ä—É—Ç–∏–Ω–∞ –∑–∞–≤–µ—Ä—à–∏–ª–∞—Å—å")
}

/*  –í—ã–≤–æ–¥:
    –í—Å–µ –≤–æ—Ä–∫–µ—Ä—ã –∑–∞–ø—É—â–µ–Ω—ã
    –í–æ—Ä–∫–µ—Ä 1 —Å—Ç–∞—Ä—Ç–æ–≤–∞–ª
    –í–æ—Ä–∫–µ—Ä 3 —Å—Ç–∞—Ä—Ç–æ–≤–∞–ª
    –í–æ—Ä–∫–µ—Ä 2 —Å—Ç–∞—Ä—Ç–æ–≤–∞–ª
    –í–æ—Ä–∫–µ—Ä 4 —Å—Ç–∞—Ä—Ç–æ–≤–∞–ª
    –í–æ—Ä–∫–µ—Ä 5 —Å—Ç–∞—Ä—Ç–æ–≤–∞–ª
    –í–æ—Ä–∫–µ—Ä 1 –∑–∞–≤–µ—Ä—à—ë–Ω
    –í–æ—Ä–∫–µ—Ä 2 –∑–∞–≤–µ—Ä—à—ë–Ω
    –í–æ—Ä–∫–µ—Ä 3 –∑–∞–≤–µ—Ä—à—ë–Ω
    –í–æ—Ä–∫–µ—Ä 4 –∑–∞–≤–µ—Ä—à—ë–Ω
    –í–æ—Ä–∫–µ—Ä 5 –∑–∞–≤–µ—Ä—à—ë–Ω
    –ì–ª–∞–≤–Ω–∞—è –≥–æ—Ä—É—Ç–∏–Ω–∞ –∑–∞–≤–µ—Ä—à–∏–ª–∞—Å—å

*/
```

–ì–ª–∞–≤–Ω–∞—è –≥–æ—Ä—É—Ç–∏–Ω–∞ (—Ñ—É–Ω–∫—Ü–∏—è `main`) –∑–∞–≤–µ—Ä—à–∏—Ç—Å—è ‚Äî –ø—Ä–æ–≥—Ä–∞–º–º–∞ –∑–∞–≤–µ—Ä—à–∏—Ç—Å—è, –¥–∞–∂–µ –µ—Å–ª–∏ –¥—Ä—É–≥–∏–µ –≥–æ—Ä—É—Ç–∏–Ω—ã –µ—â—ë —Ä–∞–±–æ—Ç–∞—é—Ç. –ü–æ—ç—Ç–æ–º—É —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º `time.Sleep` –∏–ª–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é.

## –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è

–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –≤ Go (–∏ –≤ –º–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω–æ—Å—Ç–∏ –≤–æ–æ–±—â–µ) ‚Äî —ç—Ç–æ –ø—Ä–∞–≤–∏–ª–∞ –∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–º–æ–≥–∞—é—Ç –Ω–µ—Å–∫–æ–ª—å–∫–∏–º –≥–æ—Ä—É—Ç–∏–Ω–∞–º —Ä–∞–±–æ—Ç–∞—Ç—å —Å –æ–±—â–∏–º–∏ –¥–∞–Ω–Ω—ã–º–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ, —á—Ç–æ–±—ã –æ–Ω–∏ –Ω–µ "–ø–µ—Ä–µ–ø—É—Ç–∞–ª–∏" –≤—Å—ë –∏ –Ω–µ —Å–ª–æ–º–∞–ª–∏ –ø—Ä–æ–≥—Ä–∞–º–º—É.

### sync.WaitGroup

**sync.WaitGroup** ‚Äî —ç—Ç–æ –ø—Ä–æ—Å—Ç–æ–π –∏ —É–¥–æ–±–Ω—ã–π –º–µ—Ö–∞–Ω–∏–∑–º –∏–∑ –ø–∞–∫–µ—Ç–∞ `sync`, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–º–æ–≥–∞–µ—Ç –≥–ª–∞–≤–Ω–æ–π –≥–æ—Ä—É—Ç–∏–Ω–µ –¥–æ–∂–¥–∞—Ç—å—Å—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –¥—Ä—É–≥–∏—Ö –≥–æ—Ä—É—Ç–∏–Ω (–≤–æ—Ä–∫–µ—Ä–æ–≤).

–ü—Ä–µ–¥—Å—Ç–∞–≤—å: —Ç—ã –∑–∞–ø—É—Å–∫–∞–µ—à—å 5 –≥–æ—Ä—É—Ç–∏–Ω, –∫–æ—Ç–æ—Ä—ã–µ –≤—ã–ø–æ–ª–Ω—è—é—Ç —Ä–∞–±–æ—Ç—É –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ. –ë–µ–∑ `WaitGroup` –≥–ª–∞–≤–Ω–∞—è –ø—Ä–æ–≥—Ä–∞–º–º–∞ –º–æ–∂–µ—Ç –∑–∞–≤–µ—Ä—à–∏—Ç—å—Å—è —Ä–∞–Ω—å—à–µ, —á–µ–º —ç—Ç–∏ –≥–æ—Ä—É—Ç–∏–Ω—ã –∑–∞–∫–æ–Ω—á–∞—Ç —Å–≤–æ—é —Ä–∞–±–æ—Ç—É. `WaitGroup` —Ä–µ—à–∞–µ—Ç —ç—Ç—É –ø—Ä–æ–±–ª–µ–º—É.

#### –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç (–ø–æ —à–∞–≥–∞–º):
1. –°–æ–∑–¥–∞—ë—à—å –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é: `var wg sync.WaitGroup`
2. –ü–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º –∫–∞–∂–¥–æ–π –≥–æ—Ä—É—Ç–∏–Ω—ã –≤—ã–∑—ã–≤–∞–µ—à—å `wg.Add(1)` ‚Äî –≥–æ–≤–æ—Ä–∏—à—å: "–æ–∂–∏–¥–∞–µ—Ç—Å—è –µ—â—ë –æ–¥–Ω–∞ –∑–∞–¥–∞—á–∞".
3. –í–Ω—É—Ç—Ä–∏ –≥–æ—Ä—É—Ç–∏–Ω—ã –≤ –∫–æ–Ω—Ü–µ (–ª—É—á—à–µ —á–µ—Ä–µ–∑ `defer`) –≤—ã–∑—ã–≤–∞–µ—à—å `wg.Done()` ‚Äî –≥–æ–≤–æ—Ä–∏—à—å: "—ç—Ç–∞ –∑–∞–¥–∞—á–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞" (—Å—á—ë—Ç—á–∏–∫ —É–º–µ–Ω—å—à–∞–µ—Ç—Å—è –Ω–∞ 1).
4. –í –≥–ª–∞–≤–Ω–æ–π –≥–æ—Ä—É—Ç–∏–Ω–µ –≤—ã–∑—ã–≤–∞–µ—à—å `wg.Wait()` ‚Äî –ø—Ä–æ–≥—Ä–∞–º–º–∞ –±–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è –∏ –∂–¥—ë—Ç, –ø–æ–∫–∞ —Å—á—ë—Ç—á–∏–∫ –Ω–µ —Å—Ç–∞–Ω–µ—Ç 0 (—Ç–æ –µ—Å—Ç—å –≤—Å–µ –≥–æ—Ä—É—Ç–∏–Ω—ã –Ω–µ –∑–∞–≤–µ—Ä—à–∞—Ç—Å—è).

```go
var wg sync.WaitGroup

for i := 1; i <= 5; i++ {
    wg.Add(1) // +1 –∑–∞–¥–∞—á–∞
    go func(id int) {
        defer wg.Done() // -1 –ø–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏
        worker(id)
    }(i)
}

wg.Wait() // –ñ–¥—ë–º –≤—Å–µ
fmt.Println("–í—Å–µ –≤–æ—Ä–∫–µ—Ä—ã –∑–∞–≤–µ—Ä—à–∏–ª–∏—Å—å")
```

### errgroup

–ö–æ–≥–¥–∞ —Ç—ã –∑–∞–ø—É—Å–∫–∞–µ—à—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –≥–æ—Ä—É—Ç–∏–Ω –∏ —Ö–æ—á–µ—à—å –ø–æ–¥–æ–∂–¥–∞—Ç—å, –ø–æ–∫–∞ –≤—Å–µ –∑–∞–∫–æ–Ω—á–∞—Ç (–∫–∞–∫ —Å `sync.WaitGroup`), –Ω–æ –µ—â—ë –∏ **—Å–æ–±—Ä–∞—Ç—å –æ—à–∏–±–∫–∏** –∏–ª–∏ **–æ—Ç–º–µ–Ω–∏—Ç—å –≤—Å–µ –ø—Ä–∏ –ø–µ—Ä–≤–æ–π –ø—Ä–æ–±–ª–µ–º–µ** ‚Äî –Ω–∞ –ø–æ–º–æ—â—å –ø—Ä–∏—Ö–æ–¥–∏—Ç –ø–∞–∫–µ—Ç [**`golang.org/x/sync/errgroup`**](https://pkg.go.dev/golang.org/x/sync/errgroup). –≠—Ç–æ –Ω–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞, –∞ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ (`go get golang.org/x/sync/errgroup`), –Ω–æ –æ–Ω–æ –Ω–∞—Å—Ç–æ–ª—å–∫–æ –ø–æ–ø—É–ª—è—Ä–Ω–æ –∏ –ø–æ–ª–µ–∑–Ω–æ, —á—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø–æ—á—Ç–∏ –≤ –∫–∞–∂–¥–æ–º —Å–µ—Ä—å—ë–∑–Ω–æ–º –ø—Ä–æ–µ–∫—Ç–µ –Ω–∞ Go.

#### –ó–∞—á–µ–º –Ω—É–∂–µ–Ω errgroup?

–û–±—ã—á–Ω—ã–π `sync.WaitGroup` —É–º–µ–µ—Ç —Ç–æ–ª—å–∫–æ:
- –°—á–∏—Ç–∞—Ç—å, —Å–∫–æ–ª—å–∫–æ –≥–æ—Ä—É—Ç–∏–Ω –∑–∞–ø—É—â–µ–Ω–æ.
- –ñ–¥–∞—Ç—å, –ø–æ–∫–∞ –≤—Å–µ –∑–∞–≤–µ—Ä—à–∞—Ç—Å—è.

–ù–æ –æ–Ω **–Ω–µ —É–º–µ–µ—Ç**:
- –°–æ–±–∏—Ä–∞—Ç—å –æ—à–∏–±–∫–∏ –∏–∑ –≥–æ—Ä—É—Ç–∏–Ω.
- –û—Ç–º–µ–Ω—è—Ç—å –æ—Å—Ç–∞–ª—å–Ω—ã–µ –≥–æ—Ä—É—Ç–∏–Ω—ã, –µ—Å–ª–∏ –æ–¥–Ω–∞ —É–ø–∞–ª–∞.
- –†–∞–±–æ—Ç–∞—Ç—å —Å –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º (—Ç–∞–π–º–∞—É—Ç—ã, –æ—Ç–º–µ–Ω–∞ –ø–æ —Å–∏–≥–Ω–∞–ª—É).

`errgroup` —Ä–µ—à–∞–µ—Ç –≤—Å–µ —ç—Ç–∏ –ø—Ä–æ–±–ª–µ–º—ã –æ–¥–Ω–∏–º –º–∞—Ö–æ–º.

#### errgroup.Group

```go
package main

import (
    "fmt"
    "golang.org/x/sync/errgroup"
    "time"
)

func main() {
    // –°–æ–∑–¥–∞—ë–º –≥—Ä—É–ø–ø—É –∑–∞–¥–∞—á
    var g errgroup.Group

    // –ó–∞–ø—É—Å–∫–∞–µ–º 5 "–≤–æ—Ä–∫–µ—Ä–æ–≤"
    for i := 1; i <= 5; i++ {
        num := i // –∫–æ–ø–∏—Ä—É–µ–º –∑–Ω–∞—á–µ–Ω–∏–µ, —á—Ç–æ–±—ã –∫–∞–∂–¥–∞—è –≥–æ—Ä—É—Ç–∏–Ω–∞ –ø–æ–ª—É—á–∏–ª–∞ —Å–≤–æ—ë
        g.Go(func() error {
            // –ò–º–∏—Ç–∏—Ä—É–µ–º —Ä–∞–±–æ—Ç—É
            time.Sleep(time.Duration(num) * 100 * time.Millisecond)

            if num == 3 {
                return fmt.Errorf("–≤–æ—Ä–∫–µ—Ä %d —Å–ª–æ–º–∞–ª—Å—è!", num) // –æ–¥–Ω–∞ –∑–∞–¥–∞—á–∞ —É–ø–∞–¥—ë—Ç
            }

            fmt.Printf("–í–æ—Ä–∫–µ—Ä %d —É—Å–ø–µ—à–Ω–æ –∑–∞–∫–æ–Ω—á–∏–ª\n", num)
            return nil
        })
    }

    // –ñ–¥—ë–º –≤—Å–µ –≤–æ—Ä–∫–µ—Ä—ã
    if err := g.Wait(); err != nil {
        fmt.Println("–û—à–∏–±–∫–∞:", err)
    } else {
        fmt.Println("–í—Å–µ –≤–æ—Ä–∫–µ—Ä—ã —É—Å–ø–µ—à–Ω–æ –∑–∞–≤–µ—Ä—à–∏–ª–∏—Å—å!")
    }
}

–†–µ–∑—É–ª—å—Ç–∞—Ç:
```bash
–í–æ—Ä–∫–µ—Ä 1 —É—Å–ø–µ—à–Ω–æ –∑–∞–∫–æ–Ω—á–∏–ª
–í–æ—Ä–∫–µ—Ä 2 —É—Å–ø–µ—à–Ω–æ –∑–∞–∫–æ–Ω—á–∏–ª
–í–æ—Ä–∫–µ—Ä 3 —Å–ª–æ–º–∞–ª—Å—è!
–û—à–∏–±–∫–∞: –≤–æ—Ä–∫–µ—Ä 3 —Å–ª–æ–º–∞–ª—Å—è!
```

**–ü–æ—á–µ–º—É —ç—Ç–æ —É–¥–æ–±–Ω–æ**:
- `g.Go(...)` —Å–∞–º —Å—á–∏—Ç–∞–µ—Ç, —Å–∫–æ–ª—å–∫–æ –∑–∞–¥–∞—á –∑–∞–ø—É—â–µ–Ω–æ.
- –ù–µ –Ω—É–∂–Ω–æ –ø–∏—Å–∞—Ç—å `wg.Add(1)` –∏ `defer wg.Done()`.
- –ï—Å–ª–∏ —Ö–æ—Ç—å –æ–¥–Ω–∞ –∑–∞–¥–∞—á–∞ –≤–µ—Ä–Ω—ë—Ç –æ—à–∏–±–∫—É ‚Äî `g.Wait()` —Å—Ä–∞–∑—É –≤–µ—Ä–Ω—ë—Ç —ç—Ç—É –æ—à–∏–±–∫—É.
- –ö–æ–¥ –∫–æ—Ä–æ—Ç–∫–∏–π –∏ —á–∏—Ç–∞–µ–º—ã–π.

#### –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å errgroup

- –ó–∞–ø—É—Å–∫–∞–µ—à—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –≥–æ—Ä—É—Ç–∏–Ω –∏ —Ö–æ—á–µ—à—å **—Å–æ–±—Ä–∞—Ç—å –æ—à–∏–±–∫–∏**.
- –ù—É–∂–Ω–∞ **–æ—Ç–º–µ–Ω–∞ –ø–æ —Ç–∞–π–º–∞—É—Ç—É –∏–ª–∏ —Å–∏–≥–Ω–∞–ª—É**.
- –•–æ—á–µ—à—å **–æ–≥—Ä–∞–Ω–∏—á–∏—Ç—å –ø–∞—Ä–∞–ª–ª–µ–ª–∏–∑–º**.
- –î–µ–ª–∞–µ—à—å –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –∫ –≤–Ω–µ—à–Ω–∏–º —Å–µ—Ä–≤–∏—Å–∞–º, –∑–∞–≥—Ä—É–∑–∫—É —Ñ–∞–π–ª–æ–≤, –æ–±—Ä–∞–±–æ—Ç–∫—É –¥–∞–Ω–Ω—ã—Ö.

#### –ü—Ä–æ—Å—Ç–æ–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ

| –ó–∞–¥–∞—á–∞                          | sync.WaitGroup               | errgroup.Group               |
|---------------------------------|------------------------------|------------------------------|
| –ü—Ä–æ—Å—Ç–æ –∂–¥–∞—Ç—å –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è         | –î–∞                           | –î–∞                           |
| –°–æ–±–∏—Ä–∞—Ç—å –æ—à–∏–±–∫–∏                 | –ù–µ—Ç                          | –î–∞ (–ø–µ—Ä–≤–∞—è –æ—à–∏–±–∫–∞)           |
| –û—Ç–º–µ–Ω–∞ –ø–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç—É             | –ù–µ—Ç                          | –î–∞ (WithContext)             |
| –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –ø–∞—Ä–∞–ª–ª–µ–ª–∏–∑–º–∞        | –ù–µ—Ç                          | –î–∞ (SetLimit)                |
| –ö–æ–¥ –ø—Ä–æ—â–µ –∏ —á–∏—â–µ                | –ú–Ω–æ–≥–æ boilerplate            | –ú–µ–Ω—å—à–µ –∫–æ–¥–∞                  |


> <br /> `errgroup` ‚Äî —ç—Ç–æ –∫–∞–∫ `WaitGroup` –Ω–∞ —Å—Ç–µ—Ä–æ–∏–¥–∞—Ö: –∑–∞–ø—É—Å–∫–∞–µ—à—å –≥–æ—Ä—É—Ç–∏–Ω—ã —á–µ—Ä–µ–∑ `g.Go()`, –≤–æ–∑–≤—Ä–∞—â–∞–µ—à—å `error` –µ—Å–ª–∏ —á—Ç–æ-—Ç–æ –ø–æ—à–ª–æ –Ω–µ —Ç–∞–∫, –∏ `g.Wait()` —Å–∫–∞–∂–µ—Ç, –≤—Å—ë –ª–∏ –æ–∫. –° `WithContext` –¥–æ–±–∞–≤–ª—è–µ—à—å —Ç–∞–π–º–∞—É—Ç—ã –∏ –æ—Ç–º–µ–Ω—É ‚Äî –∏ –ø–æ–ª—É—á–∞–µ—à—å –Ω–∞–¥—ë–∂–Ω—ã–π –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–π –∫–æ–¥ –±–µ–∑ —É—Ç–µ—á–µ–∫ –∏ –∑–∞–≤–∏—Å–∞–Ω–∏–π.


### sync.Mutex

**Mutex *(–ú—å—é—Ç–µ–∫—Å)*** –≤ Go ‚Äî —ç—Ç–æ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π "–∑–∞–º–æ–∫" –∏–∑ –ø–∞–∫–µ—Ç–∞ `sync`, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∑–≤–æ–ª—è–µ—Ç —Ç–æ–ª—å–∫–æ –æ–¥–Ω–æ–π –≥–æ—Ä—É—Ç–∏–Ω–µ (–ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–º—É –ø–æ—Ç–æ–∫—É) –≤ –º–æ–º–µ–Ω—Ç –≤—Ä–µ–º–µ–Ω–∏ —Ä–∞–±–æ—Ç–∞—Ç—å —Å –æ–±—â–∏–º–∏ –¥–∞–Ω–Ω—ã–º–∏, —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å –ø—É—Ç–∞–Ω–∏—Ü—ã –∏ –æ—à–∏–±–æ–∫. 

–ü—Ä–µ–¥—Å—Ç–∞–≤—å, —á—Ç–æ –Ω–µ—Å–∫–æ–ª—å–∫–æ —á–µ–ª–æ–≤–µ–∫ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –ø—ã—Ç–∞—é—Ç—Å—è –ø–∏—Å–∞—Ç—å –≤ –æ–¥–Ω—É –∏ —Ç—É –∂–µ —Ç–µ—Ç—Ä–∞–¥—å: –±–µ–∑ –∑–∞–º–∫–∞ –æ–¥–∏–Ω –ø–µ—Ä–µ–∑–∞–ø–∏—à–µ—Ç —Ç–µ–∫—Å—Ç –¥—Ä—É–≥–æ–≥–æ, –∏ –ø–æ–ª—É—á–∏—Ç—Å—è –∫–∞—à–∞ *(—ç—Ç–æ –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è –≥–æ–Ω–∫–∞ –¥–∞–Ω–Ω—ã—Ö ‚Äî race condition)*. –ú—å—é—Ç–µ–∫—Å —Ä–µ—à–∞–µ—Ç –ø—Ä–æ–±–ª–µ–º—É —Ç–∞–∫: –≥–æ—Ä—É—Ç–∏–Ω–∞ "–∑–∞—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç" –∑–∞–º–æ–∫ —á–µ—Ä–µ–∑ `mu.Lock()`, –¥–µ–ª–∞–µ—Ç —Å–≤–æ—é —Ä–∞–±–æ—Ç—É —Å –¥–∞–Ω–Ω—ã–º–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –º–µ–Ω—è–µ—Ç —Å—á—ë—Ç—á–∏–∫ –∏–ª–∏ –º–∞–ø—É), –∞ –ø–æ—Ç–æ–º "–æ—Ç–ø—É—Å–∫–∞–µ—Ç" —á–µ—Ä–µ–∑ `mu.Unlock()` ‚Äî –∏ —Ç–æ–ª—å–∫–æ —Ç–æ–≥–¥–∞ –¥—Ä—É–≥–∞—è –≥–æ—Ä—É—Ç–∏–Ω–∞ –º–æ–∂–µ—Ç –∑–∞–π—Ç–∏. –û–Ω –Ω—É–∂–µ–Ω, –∫–æ–≥–¥–∞ –Ω–µ—Å–∫–æ–ª—å–∫–æ –≥–æ—Ä—É—Ç–∏–Ω —á–∏—Ç–∞—é—Ç/–ø–∏—à—É—Ç –≤ –æ–¥–Ω—É –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ ‚Äî –±–µ–∑ –º—å—é—Ç–µ–∫—Å–∞ –ø—Ä–æ–≥—Ä–∞–º–º–∞ –º–æ–∂–µ—Ç –≤—ã–¥–∞–≤–∞—Ç—å —Å—Ç—Ä–∞–Ω–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –∏–ª–∏ –∫—Ä–∞—à–∏—Ç—å—Å—è. 

> <br /> –ú—å—é—Ç–µ–∫—Å ‚Äî —ç—Ç–æ –ø—Ä–æ—Å—Ç–æ–π "—Å–≤–µ—Ç–æ—Ñ–æ—Ä" –¥–ª—è –≥–æ—Ä—É—Ç–∏–Ω, –∫–æ—Ç–æ—Ä—ã–π –∑–∞—â–∏—â–∞–µ—Ç –æ–±—â–∏–µ –¥–∞–Ω–Ω—ã–µ –æ—Ç –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –∏ –¥–µ–ª–∞–µ—Ç –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–π –∫–æ–¥ –±–µ–∑–æ–ø–∞—Å–Ω—ã–º. üòä

#### –û—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ç–æ–¥—ã

–ú—å—é—Ç–µ–∫—Å –∏–º–µ–µ—Ç –¥–≤–∞ –æ—Å–Ω–æ–≤–Ω—ã—Ö –º–µ—Ç–æ–¥–∞:
- `Lock()` ‚Äî **–∑–∞—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç** –∑–∞–º–æ–∫. –ï—Å–ª–∏ –æ–Ω —É–∂–µ –∑–∞—Ö–≤–∞—á–µ–Ω –¥—Ä—É–≥–æ–π –≥–æ—Ä—É—Ç–∏–Ω–æ–π ‚Äî —Ç–µ–∫—É—â–∞—è –≥–æ—Ä—É—Ç–∏–Ω–∞ **–±–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è** –∏ –∂–¥—ë—Ç.
- `Unlock()` ‚Äî **–æ—Å–≤–æ–±–æ–∂–¥–∞–µ—Ç** –∑–∞–º–æ–∫. –ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ –æ–¥–Ω–∞ –∏–∑ –∂–¥—É—â–∏—Ö –≥–æ—Ä—É—Ç–∏–Ω –º–æ–∂–µ—Ç –µ–≥–æ –∑–∞—Ö–≤–∞—Ç–∏—Ç—å.

#### –ü—Ä–æ—Å—Ç–æ–π –ø—Ä–∏–º–µ—Ä
```go
package main

import (
    "fmt"
    "sync"
)

var (
    counter int        // –æ–±—â–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è
    mu      sync.Mutex // –º—å—é—Ç–µ–∫—Å –¥–ª—è –∑–∞—â–∏—Ç—ã counter
)

func increment(wg *sync.WaitGroup) {
    mu.Lock()         // –∑–∞—Ö–≤–∞—Ç—ã–≤–∞–µ–º –∑–∞–º–æ–∫
    counter++         // –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è —Å–µ–∫—Ü–∏—è ‚Äî —Ç–æ–ª—å–∫–æ –æ–¥–Ω–∞ –≥–æ—Ä—É—Ç–∏–Ω–∞ –∑–¥–µ—Å—å –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ
    mu.Unlock()       // –æ—Å–≤–æ–±–æ–∂–¥–∞–µ–º –∑–∞–º–æ–∫

    wg.Done()
}

func main() {
    var wg sync.WaitGroup

    for i := 0; i < 1000; i++ {
        wg.Add(1)
        go increment(&wg)
    }

    wg.Wait()
    fmt.Println("–ò—Ç–æ–≥:", counter) // –≤—Å–µ–≥–¥–∞ –±—É–¥–µ—Ç —Ä–æ–≤–Ω–æ 1000
}
```

–ë–µ–∑ `mu.Lock()`/`Unlock()` –∑–Ω–∞—á–µ–Ω–∏–µ `counter` –±—ã–ª–æ –±—ã –º–µ–Ω—å—à–µ 1000 –∏–∑-–∑–∞ –≥–æ–Ω–æ–∫ –¥–∞–Ω–Ω—ã—Ö.

#### –•–æ—Ä–æ—à–∞—è –ø—Ä–∞–∫—Ç–∏–∫–∞: defer Unlock()
```go
mu.Lock()
defer mu.Unlock()  // –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ –æ—Å–≤–æ–±–æ–¥–∏–º, –¥–∞–∂–µ –µ—Å–ª–∏ –ø–∞–Ω–∏–∫–∞
counter++
```

### sync.RWMutex

**RWMutex *(Read-Write Mutex)*** –≤ Go ‚Äî —ç—Ç–æ —É–ª—É—á—à–µ–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è –æ–±—ã—á–Ω–æ–≥–æ –º—å—é—Ç–µ–∫—Å–∞ –∏–∑ –ø–∞–∫–µ—Ç–∞ `sync`, –∫–æ—Ç–æ—Ä–∞—è —Ä–∞–∑–ª–∏—á–∞–µ—Ç **—á—Ç–µ–Ω–∏–µ** –∏ **–∑–∞–ø–∏—Å—å**. 

–ö–æ–≥–¥–∞ –≥–æ—Ä—É—Ç–∏–Ω–∞ —Ö–æ—á–µ—Ç —Ç–æ–ª—å–∫–æ —á–∏—Ç–∞—Ç—å –¥–∞–Ω–Ω—ã–µ ‚Äî –æ–Ω–∞ –∑–∞—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç "—á—Ç–µ–Ω–∏–µ" —á–µ—Ä–µ–∑ `RLock()`, –∏ **–º–Ω–æ–≥–æ –≥–æ—Ä—É—Ç–∏–Ω –º–æ–≥—É—Ç —á–∏—Ç–∞—Ç—å –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ** (–±—ã—Å—Ç—Ä–æ –∏ –±–µ–∑ –æ–∂–∏–¥–∞–Ω–∏—è). –ù–æ –∫–∞–∫ —Ç–æ–ª—å–∫–æ –∫—Ç–æ-—Ç–æ —Ö–æ—á–µ—Ç –∑–∞–ø–∏—Å–∞—Ç—å (–∏–∑–º–µ–Ω–∏—Ç—å –¥–∞–Ω–Ω—ã–µ) ‚Äî –æ–Ω –∑–∞—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç "–∑–∞–ø–∏—Å—å" —á–µ—Ä–µ–∑ `Lock()`, –∏ —Ç–æ–≥–¥–∞ **–≤—Å–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ (–∏ —á–∏—Ç–∞—é—â–∏–µ, –∏ –ø–∏—à—É—â–∏–µ) –∂–¥—É—Ç**, –ø–æ–∫–∞ –∑–∞–ø–∏—Å—å –Ω–µ –∑–∞–∫–æ–Ω—á–∏—Ç—Å—è. 

–≠—Ç–æ –Ω—É–∂–Ω–æ, –∫–æ–≥–¥–∞ –≤ –ø—Ä–æ–≥—Ä–∞–º–º–µ –¥–∞–Ω–Ω—ã–µ —á–∞—â–µ —á–∏—Ç–∞—é—Ç, —á–µ–º –º–µ–Ω—è—é—Ç (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∫—ç—à, –∫–æ–Ω—Ñ–∏–≥, —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞, –º–∞–ø–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π) ‚Äî –æ–±—ã—á–Ω—ã–π –º—å—é—Ç–µ–∫—Å –∑–∞—Å—Ç–∞–≤–ª—è–ª –±—ã –≤—Å–µ—Ö –∂–¥–∞—Ç—å –¥–∞–∂–µ –ø—Ä–∏ —á—Ç–µ–Ω–∏–∏, –∞ `RWMutex` –ø–æ–∑–≤–æ–ª—è–µ—Ç –º–Ω–æ–∂–µ—Å—Ç–≤—É —á–∏—Ç–∞—Ç–µ–ª–µ–π —Ä–∞–±–æ—Ç–∞—Ç—å –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ, –¥–µ–ª–∞—è –ø—Ä–æ–≥—Ä–∞–º–º—É –±—ã—Å—Ç—Ä–µ–µ –∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–µ–µ.

> <br /> `RWMutex` ‚Äî —ç—Ç–æ "—É–º–Ω—ã–π —Å–≤–µ—Ç–æ—Ñ–æ—Ä": –∑–µ–ª—ë–Ω—ã–π –¥–ª—è –≤—Å–µ—Ö —á–∏—Ç–∞—Ç–µ–ª–µ–π —Å—Ä–∞–∑—É, –Ω–æ –∫—Ä–∞—Å–Ω—ã–π –¥–ª—è –≤—Å–µ—Ö, –∫–æ–≥–¥–∞ –∫—Ç–æ-—Ç–æ –ø–∏—à–µ—Ç. üòä

#### –û—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ç–æ–¥—ã
- **`RLock()` / `RUnlock()`** ‚Äî –∑–∞–º–æ–∫ –¥–ª—è **—á—Ç–µ–Ω–∏—è**. –ú–Ω–æ–≥–æ –≥–æ—Ä—É—Ç–∏–Ω –º–æ–≥—É—Ç –∑–∞—Ö–≤–∞—Ç–∏—Ç—å –µ–≥–æ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ.
- **`Lock()` / `Unlock()`** ‚Äî –∑–∞–º–æ–∫ –¥–ª—è **–∑–∞–ø–∏—Å–∏**. –¢–æ–ª—å–∫–æ –æ–¥–Ω–∞ –≥–æ—Ä—É—Ç–∏–Ω–∞ –º–æ–∂–µ—Ç –∑–∞—Ö–≤–∞—Ç–∏—Ç—å, –∏ –≤ —ç—Ç–æ—Ç –º–æ–º–µ–Ω—Ç **–Ω–∏–∫—Ç–æ –Ω–µ –º–æ–∂–µ—Ç —á–∏—Ç–∞—Ç—å**.

#### –ü—Ä–æ—Å—Ç–æ–π –ø—Ä–∏–º–µ—Ä
```go
package main

import (
    "fmt"
    "sync"
    "time"
)

var (
    data int           // –æ–±—â–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è
    rw   sync.RWMutex  // RWMutex –¥–ª—è –∑–∞—â–∏—Ç—ã
)

func read(id int) {
    rw.RLock()         // –Ω–µ—Å–∫–æ–ª—å–∫–æ —á–∏—Ç–∞—Ç–µ–ª–µ–π –º–æ–≥—É—Ç –±—ã—Ç—å –∑–¥–µ—Å—å –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ
    defer rw.RUnlock()

    fmt.Printf("–ì–æ—Ä—É—Ç–∏–Ω–∞ %d —á–∏—Ç–∞–µ—Ç: %d\n", id, data)
    time.Sleep(100 * time.Millisecond)  // –∏–º–∏—Ç–∏—Ä—É–µ–º —Ä–∞–±–æ—Ç—É
}

func write(id int, newValue int) {
    rw.Lock()          // —Ç–æ–ª—å–∫–æ –æ–¥–Ω–∞ –≥–æ—Ä—É—Ç–∏–Ω–∞ –º–æ–∂–µ—Ç –ø–∏—Å–∞—Ç—å
    defer rw.Unlock()

    fmt.Printf("–ì–æ—Ä—É—Ç–∏–Ω–∞ %d –ø–∏—à–µ—Ç: %d\n", id, newValue)
    data = newValue
    time.Sleep(200 * time.Millisecond)
}

func main() {
    var wg sync.WaitGroup

    // 5 —á–∏—Ç–∞—Ç–µ–ª–µ–π –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ
    for i := 1; i <= 5; i++ {
        wg.Add(1)
        go func(id int) {
            defer wg.Done()
            read(id)
        }(i)
    }

    // –û–¥–∏–Ω –ø–∏—Å–∞—Ç–µ–ª—å
    wg.Add(1)
    go func() {
        defer wg.Done()
        write(99, 42)
    }()

    wg.Wait()
}
```

–í—ã–≤–æ–¥ –ø–æ–∫–∞–∂–µ—Ç, —á—Ç–æ –≤—Å–µ —á–∏—Ç–∞—Ç–µ–ª–∏ —Ä–∞–±–æ—Ç–∞—é—Ç –ø–æ—á—Ç–∏ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ, –∞ –ø–∏—Å–∞—Ç–µ–ª—å –±–ª–æ–∫–∏—Ä—É–µ—Ç –≤—Å–µ—Ö –Ω–∞ –≤—Ä–µ–º—è –∑–∞–ø–∏—Å–∏.

#### –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å RWMutex
- **–ú–Ω–æ–≥–æ —á—Ç–µ–Ω–∏–π, –º–∞–ª–æ –∑–∞–ø–∏—Å–µ–π** (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∫—ç—à, –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è, —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫).
- –ß—Ç–µ–Ω–∏–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —á–∞—Å—Ç–æ –∏ –¥–æ–ª–≥–æ ‚Äî –æ–±—ã—á–Ω—ã–π Mutex —Å–∏–ª—å–Ω–æ —Ç–æ—Ä–º–æ–∑–∏–ª –±—ã –ø—Ä–æ–≥—Ä–∞–º–º—É.
- –ü—Ä–∏–º–µ—Ä—ã: –∫—ç—à –≤ –≤–µ–±-—Å–µ—Ä–≤–µ—Ä–µ, —á—Ç–µ–Ω–∏–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –≤ –ø–∞–º—è—Ç–∏, —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞.

#### –ö–æ–≥–¥–∞ –ù–ï –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å
- –ï—Å–ª–∏ –∑–∞–ø–∏—Å–∏ –ø—Ä–æ–∏—Å—Ö–æ–¥—è—Ç —á–∞—Å—Ç–æ ‚Äî RWMutex –º–æ–∂–µ—Ç –±—ã—Ç—å –º–µ–¥–ª–µ–Ω–Ω–µ–µ –æ–±—ã—á–Ω–æ–≥–æ Mutex (–∏–∑-–∑–∞ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –ª–æ–≥–∏–∫–∏).
- –ï—Å–ª–∏ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è —Å–µ–∫—Ü–∏—è –æ—á–µ–Ω—å –∫–æ—Ä–æ—Ç–∫–∞—è ‚Äî —Ä–∞–∑–Ω–∏—Ü–∞ –Ω–µ–∑–∞–º–µ—Ç–Ω–∞, –ª—É—á—à–µ –ø—Ä–æ—Å—Ç–æ–π `Mutex`.
- –ï—Å–ª–∏ –º–æ–∂–Ω–æ –æ–±–æ–π—Ç–∏—Å—å –∫–∞–Ω–∞–ª–∞–º–∏ –∏–ª–∏ –Ω–µ–∏–∑–º–µ–Ω—è–µ–º—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏ ‚Äî –µ—â—ë –ª—É—á—à–µ.

#### –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –æ–±—ã—á–Ω—ã–º Mutex
| –°–∏—Ç—É–∞—Ü–∏—è                  | sync.Mutex             | sync.RWMutex                     |
|---------------------------|------------------------|----------------------------------|
| –¢–æ–ª—å–∫–æ –æ–¥–Ω–∞ –≥–æ—Ä—É—Ç–∏–Ω–∞ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ | –î–∞                     | –î–ª—è –∑–∞–ø–∏—Å–∏ ‚Äî –¥–∞, –¥–ª—è —á—Ç–µ–Ω–∏—è ‚Äî –Ω–µ—Ç |
| –ú–Ω–æ–≥–æ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —á—Ç–µ–Ω–∏–π | –ù–µ—Ç (–±–ª–æ–∫–∏—Ä—É–µ—Ç –≤—Å–µ—Ö)   | –î–∞ (—Ä–∞–∑—Ä–µ—à–∞–µ—Ç)                   |
| –°–∫–æ—Ä–æ—Å—Ç—å –ø—Ä–∏ —á–∞—Å—Ç—ã—Ö –∑–∞–ø–∏—Å—è—Ö| –û–±—ã—á–Ω–æ –±—ã—Å—Ç—Ä–µ–µ         | –ú–æ–∂–µ—Ç –±—ã—Ç—å –º–µ–¥–ª–µ–Ω–Ω–µ–µ             |


### –ö–∞–Ω–∞–ª—ã (channels)

**–ö–∞–Ω–∞–ª—ã** –≤ Go ‚Äî —ç—Ç–æ —Å–ø–µ—Ü–∏–∞–ª—å–Ω–∞—è "—Ç—Ä—É–±–∞" –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–π –ø–µ—Ä–µ–¥–∞—á–∏ –¥–∞–Ω–Ω—ã—Ö –º–µ–∂–¥—É –≥–æ—Ä—É—Ç–∏–Ω–∞–º–∏ (–ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–º–∏ –ø–æ—Ç–æ–∫–∞–º–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è). –¢—ã —Å–æ–∑–¥–∞—ë—à—å –∫–∞–Ω–∞–ª –∫–æ–º–∞–Ω–¥–æ–π `ch := make(chan int)` (–Ω–∞–ø—Ä–∏–º–µ—Ä, –¥–ª—è —á–∏—Å–µ–ª), –æ–¥–Ω–∞ –≥–æ—Ä—É—Ç–∏–Ω–∞ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –¥–∞–Ω–Ω—ã–µ —á–µ—Ä–µ–∑ `ch <- 42`, –∞ –¥—Ä—É–≥–∞—è –ø–æ–ª—É—á–∞–µ—Ç —á–µ—Ä–µ–∑ `value := <-ch` ‚Äî –∏ –≤—Å—ë —ç—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ –∏ –±–µ–∑ —Ä–∏—Å–∫–∞ –≥–æ–Ω–æ–∫ –¥–∞–Ω–Ω—ã—Ö (race condition). 

–ö–∞–Ω–∞–ª—ã –Ω—É–∂–Ω—ã, —á—Ç–æ–±—ã –≥–æ—Ä—É—Ç–∏–Ω—ã –º–æ–≥–ª–∏ –æ–±—â–∞—Ç—å—Å—è –∏ –∫–æ–æ—Ä–¥–∏–Ω–∏—Ä–æ–≤–∞—Ç—å —Ä–∞–±–æ—Ç—É: –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤—ã—á–∏—Å–ª–µ–Ω–∏–π, —Å–∏–≥–Ω–∞–ª—ã –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è, –∑–∞–¥–∞—á–∏ –≤ –æ—á–µ—Ä–µ–¥—å –∏–ª–∏ –ø—Ä–æ—Å—Ç–æ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å –¥–µ–π—Å—Ç–≤–∏—è (–∫–∞–∫ "—Å–≤–µ—Ç–æ—Ñ–æ—Ä"). –ë–µ–∑ –∫–∞–Ω–∞–ª–æ–≤ –ø—Ä–∏—à–ª–æ—Å—å –±—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –º—å—é—Ç–µ–∫—Å—ã –∏ –æ–±—â–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ, —á—Ç–æ —Å–ª–æ–∂–Ω–µ–µ –∏ –æ–ø–∞—Å–Ω–µ–µ –æ—à–∏–±–æ–∫. 

> <br /> –ö–∞–Ω–∞–ª—ã ‚Äî —ç—Ç–æ –ø—Ä–æ—Å—Ç–æ–π, –±–µ–∑–æ–ø–∞—Å–Ω—ã–π –∏ –∏–¥–∏–æ–º–∞—Ç–∏—á–Ω—ã–π —Å–ø–æ—Å–æ–± "—Ä–∞–∑–≥–æ–≤–∞—Ä–∏–≤–∞—Ç—å" –º–µ–∂–¥—É –≥–æ—Ä—É—Ç–∏–Ω–∞–º–∏, –±–ª–∞–≥–æ–¥–∞—Ä—è –∫–æ—Ç–æ—Ä–æ–º—É Go —Ç–∞–∫ —É–¥–æ–±–Ω–æ –ø–∏—à–µ—Ç –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–π –∫–æ–¥. üòä


#### 1. –°–æ–∑–¥–∞–Ω–∏–µ –∫–∞–Ω–∞–ª–æ–≤
```go
ch := make(chan int)                  // –Ω–µ–±—É—Ñ–µ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–π –∫–∞–Ω–∞–ª –¥–ª—è int
buffered := make(chan string, 10)     // –±—É—Ñ–µ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–π –Ω–∞ 10 —ç–ª–µ–º–µ–Ω—Ç–æ–≤
```

- **–ù–µ–±—É—Ñ–µ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–π** ‚Äî –æ—Ç–ø—Ä–∞–≤–∫–∞ –∏ –ø–æ–ª—É—á–µ–Ω–∏–µ —Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã: –æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—å –±–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è, –ø–æ–∫–∞ –ø–æ–ª—É—á–∞—Ç–µ–ª—å –Ω–µ –≥–æ—Ç–æ–≤ (–∏ –Ω–∞–æ–±–æ—Ä–æ—Ç).
- **–ë—É—Ñ–µ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–π** ‚Äî –æ—Ç–ø—Ä–∞–≤–∫–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç, –ø–æ–∫–∞ –≤ –±—É—Ñ–µ—Ä–µ –µ—Å—Ç—å –º–µ—Å—Ç–æ. –ï—Å–ª–∏ –±—É—Ñ–µ—Ä –ø–æ–ª–æ–Ω ‚Äî –æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—å –±–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è.

#### 2. –û—Å–Ω–æ–≤–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏
```go
ch <- 42          // –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ –≤ –∫–∞–Ω–∞–ª
x := <-ch         // –ø–æ–ª—É—á–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ (–±–ª–æ–∫–∏—Ä—É–µ—Ç, –µ—Å–ª–∏ –∫–∞–Ω–∞–ª –ø—É—Å—Ç)
<-ch              // –ø–æ–ª—É—á–∏—Ç—å –∏ –æ—Ç–±—Ä–æ—Å–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ

close(ch)         // –∑–∞–∫—Ä—ã—Ç—å –∫–∞–Ω–∞–ª (—Ç–æ–ª—å–∫–æ –æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—å –¥–æ–ª–∂–µ–Ω —ç—Ç–æ –¥–µ–ª–∞—Ç—å!)
```

#### 3. –ü–æ–ª—É—á–µ–Ω–∏–µ —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π
```go
v, ok := <-ch
if ok {
    fmt.Println("–ü–æ–ª—É—á–∏–ª–∏:", v)
} else {
    fmt.Println("–ö–∞–Ω–∞–ª –∑–∞–∫—Ä—ã—Ç")
}
```

- –ü–æ—Å–ª–µ `close(ch)` –≤—Å–µ –ø–æ–ª—É—á–∞—Ç–µ–ª–∏ –±—É–¥—É—Ç –ø–æ–ª—É—á–∞—Ç—å –Ω—É–ª–µ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –∏ `ok == false`.

#### 4. –ò—Ç–µ—Ä–∞—Ü–∏—è –ø–æ –∫–∞–Ω–∞–ª—É
–°–∞–º—ã–π —É–¥–æ–±–Ω—ã–π —Å–ø–æ—Å–æ–± —á–∏—Ç–∞—Ç—å –≤—Å—ë –¥–æ –∑–∞–∫—Ä—ã—Ç–∏—è:
```go
for value := range ch {
    fmt.Println(value)
}
```
// –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è, –∫–æ–≥–¥–∞ –∫–∞–Ω–∞–ª –∑–∞–∫—Ä—ã—Ç –∏ –ø—É—Å—Ç.

#### 5. select ‚Äî —Ä–∞–±–æ—Ç–∞ —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –∫–∞–Ω–∞–ª–∞–º–∏
`select` –≤—ã–±–∏—Ä–∞–µ—Ç –≥–æ—Ç–æ–≤—É—é –æ–ø–µ—Ä–∞—Ü–∏—é (–∫–∞–∫ switch, –Ω–æ –¥–ª—è –∫–∞–Ω–∞–ª–æ–≤):
```go
select {
case v := <-ch1:
    fmt.Println("–ò–∑ ch1:", v)
case ch2 <- 100:
    fmt.Println("–û—Ç–ø—Ä–∞–≤–∏–ª–∏ –≤ ch2")
case <-time.After(2 * time.Second):
    fmt.Println("–¢–∞–π–º–∞—É—Ç!")
default:
    fmt.Println("–ù–∏—á–µ–≥–æ –Ω–µ –≥–æ—Ç–æ–≤–æ –ø—Ä—è–º–æ —Å–µ–π—á–∞—Å")
}
```

- –ï—Å–ª–∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ case –≥–æ—Ç–æ–≤—ã ‚Äî –≤—ã–±–∏—Ä–∞–µ—Ç—Å—è —Å–ª—É—á–∞–π–Ω—ã–π.
- `default` ‚Äî –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è —Å—Ä–∞–∑—É, –µ—Å–ª–∏ –Ω–∏—á–µ–≥–æ –Ω–µ –≥–æ—Ç–æ–≤–æ (–Ω–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç).


#### 6. –ù–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ –∫–∞–Ω–∞–ª—ã (direction)
–ú–æ–∂–Ω–æ —è–≤–Ω–æ —É–∫–∞–∑–∞—Ç—å –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ ‚Äî —ç—Ç–æ –¥–µ–ª–∞–µ—Ç –∫–æ–¥ –±–µ–∑–æ–ø–∞—Å–Ω–µ–µ:
```go
func producer(ch chan<- int) {  // —Ç–æ–ª—å–∫–æ –æ—Ç–ø—Ä–∞–≤–∫–∞
    ch <- 42
}

func consumer(ch <-chan int) {  // —Ç–æ–ª—å–∫–æ –ø–æ–ª—É—á–µ–Ω–∏–µ
    v := <-ch
}
```

#### 7. –¢–∏–ø–∏—á–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
- **–°–∏–≥–Ω–∞–ª –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è**: `done := make(chan struct{})` ‚Üí `done <- struct{}{}`
- **Pipeline**: –æ–¥–∏–Ω –∫–∞–Ω–∞–ª –Ω–∞ –≤—ã—Ö–æ–¥–µ –æ–¥–Ω–æ–π –≥–æ—Ä—É—Ç–∏–Ω—ã ‚Äî –≤—Ö–æ–¥ –¥–ª—è —Å–ª–µ–¥—É—é—â–µ–π.
- **Fan-out / Fan-in**: –Ω–µ—Å–∫–æ–ª—å–∫–æ –≤–æ—Ä–∫–µ—Ä–æ–≤ —á–∏—Ç–∞—é—Ç –∏–∑ –æ–¥–Ω–æ–≥–æ –∫–∞–Ω–∞–ª–∞ (fan-out), —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–æ–±–∏—Ä–∞—é—Ç—Å—è –≤ –¥—Ä—É–≥–æ–π (fan-in).
- **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –ø–∞—Ä–∞–ª–ª–µ–ª–∏–∑–º–∞**: –±—É—Ñ–µ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–π –∫–∞–Ω–∞–ª –Ω–∞ N —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –∫–∞–∫ —Å–µ–º–∞—Ñ–æ—Ä.

#### 8. –ß–∞—Å—Ç—ã–µ –æ—à–∏–±–∫–∏ –Ω–æ–≤–∏—á–∫–æ–≤
- –ó–∞–±—ã—Ç—å `close(ch)` ‚Äî –ø–æ–ª—É—á–∞—Ç–µ–ª–∏ –±—É–¥—É—Ç –≤–∏—Å–µ—Ç—å –≤–µ—á–Ω–æ.
- –ó–∞–∫—Ä—ã–≤–∞—Ç—å –∫–∞–Ω–∞–ª –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑ ‚Äî –ø–∞–Ω–∏–∫–∞.
- –û—Ç–ø—Ä–∞–≤–ª—è—Ç—å –≤ –∑–∞–∫—Ä—ã—Ç—ã–π –∫–∞–Ω–∞–ª ‚Äî –ø–∞–Ω–∏–∫–∞.
- –û—Ç–ø—Ä–∞–≤–ª—è—Ç—å –≤ nil-–∫–∞–Ω–∞–ª ‚Äî –≤–µ—á–Ω–∞—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞.
- –ù–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `range` –∏–ª–∏ `select` ‚Äî –ª–µ–≥–∫–æ –ø–æ–ª—É—á–∏—Ç—å deadlock.


### sync.Once

**`sync.Once`** ‚Äî —ç—Ç–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∏–∑ –ø–∞–∫–µ—Ç–∞ `sync`, –∫–æ—Ç–æ—Ä–∞—è –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç, —á—Ç–æ **–æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –≤—ã–ø–æ–ª–Ω–∏—Ç—Å—è —Ä–æ–≤–Ω–æ –æ–¥–∏–Ω —Ä–∞–∑**, –¥–∞–∂–µ –µ—Å–ª–∏ –µ—ë –≤—ã–∑–æ–≤—É—Ç –∏–∑ –º–Ω–æ–≥–∏—Ö –≥–æ—Ä—É—Ç–∏–Ω –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ.

–≠—Ç–æ –∏–¥–µ–∞–ª—å–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è **–ª–µ–Ω–∏–≤–æ–π –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏** (lazy initialization) —á–µ–≥–æ-—Ç–æ –¥–æ—Ä–æ–≥–æ–≥–æ: –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö, –∑–∞–≥—Ä—É–∑–∫–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏, —Å–æ–∑–¥–∞–Ω–∏—è singleton –∏ —Ç.–¥.

#### –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç
–£ `sync.Once` –µ—Å—Ç—å —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω –≤–∞–∂–Ω—ã–π –º–µ—Ç–æ–¥:
- **`Do(f func())`** ‚Äî –≤—ã–∑—ã–≤–∞–µ—Ç —Ñ—É–Ω–∫—Ü–∏—é `f` **—Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ä–∞–∑**.  
  –í—Å–µ –ø–æ—Å–ª–µ–¥—É—é—â–∏–µ –≤—ã–∑–æ–≤—ã `Do()` —Å —Ç–æ–π –∂–µ `Once` –ø—Ä–æ—Å—Ç–æ –ø–æ–¥–æ–∂–¥—É—Ç –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –ø–µ—Ä–≤–æ–≥–æ –≤—ã–∑–æ–≤–∞ (–µ—Å–ª–∏ –æ–Ω –µ—â—ë –∏–¥—ë—Ç) –∏ —Å—Ä–∞–∑—É –≤–µ—Ä–Ω—É—Ç—Å—è, –Ω–µ –∑–∞–ø—É—Å–∫–∞—è —Ñ—É–Ω–∫—Ü–∏—é —Å–Ω–æ–≤–∞.

#### –ü—Ä–æ—Å—Ç–æ–π –ø—Ä–∏–º–µ—Ä
```go
package main

import (
    "fmt"
    "sync"
)

var (
    once     sync.Once
    config   map[string]string  // –±—É–¥–µ—Ç –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ä–∞–∑
)

func loadConfig() {
    fmt.Println("–ó–∞–≥—Ä—É–∂–∞—é –∫–æ–Ω—Ñ–∏–≥... (–¥–æ—Ä–æ–≥–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è)")
    config = map[string]string{
        "host": "localhost",
        "port": "8080",
    }
}

func getConfig() map[string]string {
    once.Do(loadConfig)  // –≤—ã–ø–æ–ª–Ω–∏—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –≤—ã–∑–æ–≤–µ
    return config
}

func main() {
    var wg sync.WaitGroup

    for i := 1; i <= 5; i++ {
        wg.Add(1)
        go func(id int) {
            defer wg.Done()
            cfg := getConfig()
            fmt.Printf("–ì–æ—Ä—É—Ç–∏–Ω–∞ %d –ø–æ–ª—É—á–∏–ª–∞ –∫–æ–Ω—Ñ–∏–≥: %v\n", id, cfg)
        }(i)
    }

    wg.Wait()
}
```

–í—ã–≤–æ–¥:
```
–ó–∞–≥—Ä—É–∂–∞—é –∫–æ–Ω—Ñ–∏–≥... (–¥–æ—Ä–æ–≥–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è)  // —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ä–∞–∑!
–ì–æ—Ä—É—Ç–∏–Ω–∞ 1 –ø–æ–ª—É—á–∏–ª–∞ –∫–æ–Ω—Ñ–∏–≥: map[host:localhost port:8080]
–ì–æ—Ä—É—Ç–∏–Ω–∞ 3 –ø–æ–ª—É—á–∏–ª–∞ –∫–æ–Ω—Ñ–∏–≥: map[host:localhost port:8080]
...
```

–î–∞–∂–µ –µ—Å–ª–∏ 5 –≥–æ—Ä—É—Ç–∏–Ω –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –≤—ã–∑–æ–≤—É—Ç `getConfig()`, —Ñ—É–Ω–∫—Ü–∏—è `loadConfig` –≤—ã–ø–æ–ª–Ω–∏—Ç—Å—è —Ä–æ–≤–Ω–æ –æ–¥–∏–Ω —Ä–∞–∑.

#### –ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π –ø–∞—Ç—Ç–µ—Ä–Ω singleton
```go
var (
    once     sync.Once
    instance *MySingleton
)

func GetInstance() *MySingleton {
    once.Do(func() {
        instance = &MySingleton{}
        // –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è instance
    })
    return instance
}
```

#### –í–∞–∂–Ω—ã–µ –º–æ–º–µ–Ω—Ç—ã
- `once.Do()` –±–µ–∑–æ–ø–∞—Å–µ–Ω –¥–ª—è –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–≥–æ –≤—ã–∑–æ–≤–∞ –∏–∑ –º–Ω–æ–≥–∏—Ö –≥–æ—Ä—É—Ç–∏–Ω.
- –ï—Å–ª–∏ —Ñ—É–Ω–∫—Ü–∏—è –≤–Ω—É—Ç—Ä–∏ `Do()` –∑–∞–ø–∞–Ω–∏–∫—É–µ—Ç ‚Äî –ø–∞–Ω–∏–∫–∞ –ø—Ä–æ–±—Ä–æ—Å–∏—Ç—Å—è, –∞ –ø–æ—Å–ª–µ–¥—É—é—â–∏–µ –≤—ã–∑–æ–≤—ã `Do()` —Å–Ω–æ–≤–∞ –ø–æ–ø—Ä–æ–±—É—é—Ç –≤—ã–ø–æ–ª–Ω–∏—Ç—å —Ñ—É–Ω–∫—Ü–∏—é (–Ω–æ –æ–±—ã—á–Ω–æ —ç—Ç–æ –Ω–µ –Ω—É–∂–Ω–æ).
- –û–±—ã—á–Ω–æ –∏—Å–ø–æ–ª—å–∑—É—é—Ç **–æ–¥–Ω—É –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é** `sync.Once` –Ω–∞ –æ–¥–Ω—É –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é.

#### –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å
- –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –≥–ª–æ–±–∞–ª—å–Ω—ã—Ö —Ä–µ—Å—É—Ä—Å–æ–≤ (–ë–î, –ª–æ–≥–≥–µ—Ä, –∫—ç—à).
- –õ–µ–Ω–∏–≤–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ —Ç—è–∂—ë–ª—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤.
- –ì–∞—Ä–∞–Ω—Ç–∏—è –æ–¥–Ω–æ–∫—Ä–∞—Ç–Ω–æ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è setup-–∫–æ–¥–∞.

#### –ö–æ–≥–¥–∞ –ù–ï –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å
- –ï—Å–ª–∏ –Ω—É–∂–Ω–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å —á—Ç–æ-—Ç–æ –æ–¥–∏–Ω —Ä–∞–∑, –Ω–æ –Ω–µ –≤ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–º –∫–æ–¥–µ ‚Äî –ø—Ä–æ—Å—Ç–æ –æ–±—ã—á–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è.
- –ï—Å–ª–∏ –Ω—É–∂–Ω–∞ –ø–æ–≤—Ç–æ—Ä–Ω–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ —É—Å–ª–æ–≤–∏—é ‚Äî —ç—Ç–æ –Ω–µ –¥–ª—è `Once`.

### –ê—Ç–æ–º–∞—Ä–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ (atomic)

**–ê—Ç–æ–º–∏–∫–∏ *(atomic operations)*** –≤ Go ‚Äî —ç—Ç–æ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –∏–∑ –ø–∞–∫–µ—Ç–∞ `sync/atomic`, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–∑–≤–æ–ª—è—é—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ —á–∏—Ç–∞—Ç—å –∏ –º–µ–Ω—è—Ç—å –ø—Ä–æ—Å—Ç—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è (—á–∏—Å–ª–∞, —É–∫–∞–∑–∞—Ç–µ–ª–∏) –≤ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –≥–æ—Ä—É—Ç–∏–Ω–∞—Ö –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ, –±–µ–∑ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –º—å—é—Ç–µ–∫—Å–æ–≤. 

–ü—Ä–µ–¥—Å—Ç–∞–≤—å —Å—á—ë—Ç—á–∏–∫ –ø–æ—Å–µ—Ç–∏—Ç–µ–ª–µ–π —Å–∞–π—Ç–∞: –µ—Å–ª–∏ –æ–±—ã—á–Ω—ã–π `count++` –¥–µ–ª–∞—Ç—å –∏–∑ —Ä–∞–∑–Ω—ã—Ö –≥–æ—Ä—É—Ç–∏–Ω ‚Äî –º–æ–∂–µ—Ç –ø–æ–ª—É—á–∏—Ç—å—Å—è –æ—à–∏–±–∫–∞ (–æ–¥–Ω–∞ –≥–æ—Ä—É—Ç–∏–Ω–∞ –ø–µ—Ä–µ–∑–∞–ø–∏—à–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–µ –¥—Ä—É–≥–æ–π). –ê—Ç–æ–º–∏–∫–∏ —Ä–µ—à–∞—é—Ç —ç—Ç–æ –Ω–∞ —É—Ä–æ–≤–Ω–µ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞: –æ–ø–µ—Ä–∞—Ü–∏–∏ –≤—Ä–æ–¥–µ `atomic.AddInt64(&count, 1)` –∏–ª–∏ `atomic.LoadInt64(&count)` –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –∫–∞–∫ **–æ–¥–Ω–æ –Ω–µ–¥–µ–ª–∏–º–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ** ‚Äî –Ω–∏–∫—Ç–æ –Ω–µ –º–æ–∂–µ—Ç "–≤–ª–µ–∑—Ç—å" –ø–æ—Å–µ—Ä–µ–¥–∏–Ω–µ. 

–û–Ω–∏ –Ω—É–∂–Ω—ã –¥–ª—è –ø—Ä–æ—Å—Ç—ã—Ö –≤–µ—â–µ–π: —Å—á—ë—Ç—á–∏–∫–∏, —Ñ–ª–∞–≥–∏ (–≤–∫–ª—é—á–µ–Ω–æ/–≤—ã–∫–ª—é—á–µ–Ω–æ), —É–∫–∞–∑–∞—Ç–µ–ª–∏ ‚Äî –∫–æ–≥–¥–∞ –Ω–µ —Ö–æ—á–µ—Ç—Å—è —Ç—è–∂—ë–ª–æ–≥–æ –º—å—é—Ç–µ–∫—Å–∞, –∞ –Ω—É–∂–Ω–∞ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å. 

> <br /> –ê—Ç–æ–º–∏–∫–∏ ‚Äî —ç—Ç–æ —Å–≤–µ—Ä—Ö–±—ã—Å—Ç—Ä—ã–π –∏ –ª—ë–≥–∫–∏–π "–∑–∞–º–æ–∫" —Ç–æ–ª—å–∫–æ –¥–ª—è –ø—Ä–æ—Å—Ç—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö, —á—Ç–æ–±—ã –≥–æ—Ä—É—Ç–∏–Ω—ã –Ω–µ –ø—É—Ç–∞–ª–∏ —á–∏—Å–ª–∞ –ø—Ä–∏ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–π —Ä–∞–±–æ—Ç–µ.

#### –û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ `sync/atomic`

| –§—É–Ω–∫—Ü–∏—è                                   | –ß—Ç–æ –¥–µ–ª–∞–µ—Ç                                          | –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è                              |
|-------------------------------------------|-----------------------------------------------------|---------------------------------------------------|
| `atomic.AddInt64(&x, delta)`              | –ü—Ä–∏–±–∞–≤–ª—è–µ—Ç delta –∫ x –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –Ω–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ    | `atomic.AddInt64(&counter, 1)` ‚Äî –±–µ–∑–æ–ø–∞—Å–Ω—ã–π ++    |
| `atomic.LoadInt64(&x)`                    | –ë–µ–∑–æ–ø–∞—Å–Ω–æ —á–∏—Ç–∞–µ—Ç —Ç–µ–∫—É—â–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ                   | `v := atomic.LoadInt64(&counter)`                 |
| `atomic.StoreInt64(&x, newValue)`         | –ë–µ–∑–æ–ø–∞—Å–Ω–æ –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç –Ω–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ                 | `atomic.StoreInt64(&done, 1)` ‚Äî —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ñ–ª–∞–≥   |
| `atomic.CompareAndSwapInt64(&x, old, new)`| –ï—Å–ª–∏ x == old ‚Üí –º–µ–Ω—è–µ—Ç –Ω–∞ new –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç true     | –î–ª—è lock-free –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤                          |
| `atomic.SwapInt64(&x, new)`               | –ú–µ–Ω—è–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å—Ç–∞—Ä–æ–µ                 | `old := atomic.SwapInt64(&counter, 0)`            |

–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ç–∏–ø—ã: `int32`, `int64`, `uint32`, `uint64`, `uintptr`, —É–∫–∞–∑–∞—Ç–µ–ª–∏ (`*T`), `atomic.Bool`, `atomic.Value` (–¥–ª—è –ª—é–±–æ–≥–æ —Ç–∏–ø–∞).

#### –ü—Ä–æ—Å—Ç–æ–π –ø—Ä–∏–º–µ—Ä: –±–µ–∑–æ–ø–∞—Å–Ω—ã–π —Å—á—ë—Ç—á–∏–∫
```go
package main

import (
    "fmt"
    "sync"
    "sync/atomic"
)

var counter int64 // –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ä–∞–∑–º–µ—Ä (int64)

func main() {
    var wg sync.WaitGroup

    for i := 0; i < 1000; i++ {
        wg.Add(1)
        go func() {
            atomic.AddInt64(&counter, 1) // –∞—Ç–æ–º–∞—Ä–Ω–æ +1
            wg.Done()
        }()
    }

    wg.Wait()
    fmt.Println("–ò—Ç–æ–≥:", atomic.LoadInt64(&counter)) // –≤—Å–µ–≥–¥–∞ —Ç–æ—á–Ω–æ 1000!
}
```

–ë–µ–∑ `atomic` —Ä–µ–∑—É–ª—å—Ç–∞—Ç –±—ã–ª –±—ã —Å–ª—É—á–∞–π–Ω—ã–º (–º–µ–Ω—å—à–µ 1000) –∏–∑-–∑–∞ –≥–æ–Ω–æ–∫.

#### –ü—Ä–∏–º–µ—Ä —Å —Ñ–ª–∞–≥–æ–º (atomic.Bool)
```go
var done atomic.Bool

go func() {
    // –¥–æ–ª–≥–∞—è —Ä–∞–±–æ—Ç–∞
    done.Store(true) // –∞—Ç–æ–º–∞—Ä–Ω–æ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ñ–ª–∞–≥
}()

for !done.Load() {
    fmt.Println("–ñ–¥—ë–º –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è...")
}
fmt.Println("–ì–æ—Ç–æ–≤–æ!")
```

#### –ü—Ä–∏–º–µ—Ä —Å —É–∫–∞–∑–∞—Ç–µ–ª–µ–º
```go
var config atomic.Value // –º–æ–∂–µ—Ç —Ö—Ä–∞–Ω–∏—Ç—å –ª—é–±–æ–π —Ç–∏–ø

config.Store(&Config{Version: 1})

// –í –¥—Ä—É–≥–æ–π –≥–æ—Ä—É—Ç–∏–Ω–µ
current := config.Load().(*Config)
fmt.Println(current.Version)
```

#### –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∞—Ç–æ–º–∏–∫–∏
- **–°—á—ë—Ç—á–∏–∫–∏** (–∑–∞–ø—Ä–æ—Å–æ–≤, –æ—à–∏–±–æ–∫, –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã—Ö –∑–∞–¥–∞—á).
- **–§–ª–∞–≥–∏** (done, stopped, ready).
- **–£–∫–∞–∑–∞—Ç–µ–ª–∏** (–∞—Ç–æ–º–∞—Ä–Ω–∞—è –∑–∞–º–µ–Ω–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏, singleton).
- –í –≤—ã—Å–æ–∫–æ–Ω–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö –º–µ—Å—Ç–∞—Ö, –≥–¥–µ –º—å—é—Ç–µ–∫—Å –±—ã–ª –±—ã bottleneck.

#### –ö–æ–≥–¥–∞ –ù–ï –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å
- –°–ª–æ–∂–Ω—ã–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã (`struct`, `map`, `slice`) ‚Äî –∞—Ç–æ–º–∏–∫–∏ —Ä–∞–±–æ—Ç–∞—é—Ç —Ç–æ–ª—å–∫–æ —Å –ø—Ä–æ—Å—Ç—ã–º–∏ —Ç–∏–ø–∞–º–∏.
- –ù–µ—Å–∫–æ–ª—å–∫–æ —Å–≤—è–∑–∞–Ω–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π ("–ø—Ä–æ—á–∏—Ç–∞—Ç—å ‚Üí –ø–æ—Å—á–∏—Ç–∞—Ç—å ‚Üí –∑–∞–ø–∏—Å–∞—Ç—å") ‚Äî –Ω—É–∂–Ω–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è (–º—å—é—Ç–µ–∫—Å).
- –ï—Å–ª–∏ –∫–æ–¥ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –º–µ–Ω–µ–µ —á–∏—Ç–∞–µ–º—ã–º ‚Äî –ª—É—á—à–µ –æ–±—ã—á–Ω—ã–π –º—å—é—Ç–µ–∫—Å.

#### –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –º—å—é—Ç–µ–∫—Å–æ–º
| –ê—Å–ø–µ–∫—Ç              | atomic                              | sync.Mutex                              |
|---------------------|-------------------------------------|-----------------------------------------|
| –°–∫–æ—Ä–æ—Å—Ç—å            | –û—á–µ–Ω—å –±—ã—Å—Ç—Ä–æ (–±–µ–∑ –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫)       | –ú–µ–¥–ª–µ–Ω–Ω–µ–µ (–º–æ–∂–µ—Ç –±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –≥–æ—Ä—É—Ç–∏–Ω—É)  |
| –ß—Ç–æ –º–æ–∂–Ω–æ –∑–∞—â–∏—Ç–∏—Ç—å  | –û–¥–∏–Ω –ø—Ä–æ—Å—Ç–æ–π —Ç–∏–ø                    | –õ—é–±—ã–µ –¥–∞–Ω–Ω—ã–µ, —Å–ª–æ–∂–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏          |
| –ß–∏—Ç–∞–µ–º–æ—Å—Ç—å          | –ò–Ω–æ–≥–¥–∞ —Å–ª–æ–∂–Ω–µ–µ                      | –û–±—ã—á–Ω–æ –ø–æ–Ω—è—Ç–Ω–µ–µ                         |
| –ì–∏–±–∫–æ—Å—Ç—å            | –ù–∏–∑–∫–∞—è                              | –í—ã—Å–æ–∫–∞—è                                 |


## –ü–∞—Ç—Ç–µ—Ä–Ω—ã 

### –ü–æ–ø—É–ª—è—Ä–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã —Ä–∞–±–æ—Ç—ã —Å –≥–æ—Ä—É—Ç–∏–Ω–∞–º–∏ –∏ –∫–∞–Ω–∞–ª–∞–º–∏ –≤ Go

–í Go –ø–∞—Ä–∞–ª–ª–µ–ª–∏–∑–º —Å—Ç—Ä–æ–∏—Ç—Å—è –≤–æ–∫—Ä—É–≥ **–≥–æ—Ä—É—Ç–∏–Ω** (`go func()`) –∏ **–∫–∞–Ω–∞–ª–æ–≤**. –í–æ—Ç —Å–∞–º—ã–µ –ø–æ–ø—É–ª—è—Ä–Ω—ã–µ –∏ –ø–æ–ª–µ–∑–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã, –∫–æ—Ç–æ—Ä—ã–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç –≤ —Ä–µ–∞–ª—å–Ω—ã—Ö –ø—Ä–æ–µ–∫—Ç–∞—Ö.

### **Worker Pool** (–ü—É–ª –≤–æ—Ä–∫–µ—Ä–æ–≤)
–û–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–µ —á–∏—Å–ª–æ –≥–æ—Ä—É—Ç–∏–Ω –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –º–Ω–æ–≥–æ –∑–∞–¥–∞—á –∏–∑ –æ—á–µ—Ä–µ–¥–∏.

```go
func main() {
    jobs := make(chan int, 100)
    results := make(chan int, 100)

    // –ó–∞–ø—É—Å–∫–∞–µ–º —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —á–∏—Å–ª–æ –≤–æ—Ä–∫–µ—Ä–æ–≤
    for w := 1; w <= 5; w++ {
        go worker(w, jobs, results)
    }

    // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∑–∞–¥–∞—á–∏
    for j := 1; j <= 20; j++ {
        jobs <- j
    }
    close(jobs)  // –±–æ–ª—å—à–µ –∑–∞–¥–∞—á –Ω–µ –±—É–¥–µ—Ç

    // –°–æ–±–∏—Ä–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
    for r := 1; r <= 20; r++ {
        <-results
    }
}

func worker(id int, jobs <-chan int, results chan<- int) {
    for job := range jobs {
        fmt.Printf("–í–æ—Ä–∫–µ—Ä %d –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∑–∞–¥–∞—á—É %d\n", id, job)
        time.Sleep(time.Second)  // –∏–º–∏—Ç–∞—Ü–∏—è —Ä–∞–±–æ—Ç—ã
        results <- job * 2
    }
}
```

**–ó–∞—á–µ–º**: –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç –ø–∞—Ä–∞–ª–ª–µ–ª–∏–∑–º (–Ω–∞–ø—Ä–∏–º–µ—Ä, –Ω–µ –±–æ–ª–µ–µ 10 –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ API).

### **Pipeline** (–ö–æ–Ω–≤–µ–π–µ—Ä)
–î–∞–Ω–Ω—ã–µ –ø—Ä–æ—Ö–æ–¥—è—Ç —á–µ—Ä–µ–∑ —Ü–µ–ø–æ—á–∫—É –æ–±—Ä–∞–±–æ—Ç–∫–∏: –∫–∞–∂–¥–∞—è —Å—Ç–∞–¥–∏—è ‚Äî –æ—Ç–¥–µ–ª—å–Ω–∞—è –≥–æ—Ä—É—Ç–∏–Ω–∞.

```go
func gen(nums ...int) <-chan int {
    out := make(chan int)
    go func() {
        for _, n := range nums {
            out <- n
        }
        close(out)
    }()
    return out
}

func sq(in <-chan int) <-chan int {
    out := make(chan int)
    go func() {
        for n := range in {
            out <- n * n
        }
        close(out)
    }()
    return out
}

func main() {
    in := gen(2, 3, 4, 5)

    // –°—Ç–∞–¥–∏–∏ –∫–æ–Ω–≤–µ–π–µ—Ä–∞
    out := sq(sq(in))  // –¥–≤–∞–∂–¥—ã –≤–æ–∑–≤–æ–¥–∏–º –≤ –∫–≤–∞–¥—Ä–∞—Ç

    for n := range out {
        fmt.Println(n)  // 16, 81, 256, 625
    }
}
```

**–ó–∞—á–µ–º**: —É–¥–æ–±–Ω–æ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –ø–æ—Ç–æ–∫–æ–≤ –¥–∞–Ω–Ω—ã—Ö (–ø–∞—Ä—Å–∏–Ω–≥, –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ, —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è).

### **Fan-out / Fan-in**
**Fan-out**: –æ–¥–Ω–∞ –≥–æ—Ä—É—Ç–∏–Ω–∞ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—è–µ—Ç –∑–∞–¥–∞—á–∏ –ø–æ –º–Ω–æ–≥–∏–º –≤–æ—Ä–∫–µ—Ä–∞–º.  
**Fan-in**: —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–æ–±–∏—Ä–∞—é—Ç—Å—è –≤ –æ–¥–∏–Ω –∫–∞–Ω–∞–ª.

```go
func main() {
    jobs := make(chan int, 100)
    results := make(chan int, 100)

    // Fan-out: –Ω–µ—Å–∫–æ–ª—å–∫–æ –≤–æ—Ä–∫–µ—Ä–æ–≤ —á–∏—Ç–∞—é—Ç –∏–∑ –æ–¥–Ω–æ–≥–æ –∫–∞–Ω–∞–ª–∞
    for w := 1; w <= 10; w++ {
        go worker(jobs, results)
    }

    // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∑–∞–¥–∞—á–∏
    for j := 1; j <= 50; j++ {
        jobs <- j
    }
    close(jobs)

    // Fan-in: —Å–æ–±–∏—Ä–∞–µ–º –≤—Å–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
    for r := 1; r <= 50; r++ {
        <-results
    }
}
```

**–ó–∞—á–µ–º**: –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –ø–∞—Ä–∞–ª–ª–µ–ª–∏–∑–º –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã—Ö –∑–∞–¥–∞—á.

### **–û–∂–∏–¥–∞–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –≤—Å–µ—Ö –≥–æ—Ä—É—Ç–∏–Ω** (WaitGroup)
–ü—Ä–æ—Å—Ç–æ–π —Å–ø–æ—Å–æ–± –¥–æ–∂–¥–∞—Ç—å—Å—è –≤—Å–µ—Ö –≤–æ—Ä–∫–µ—Ä–æ–≤.

```go
var wg sync.WaitGroup

for i := 1; i <= 5; i++ {
    wg.Add(1)
    go func(id int) {
        defer wg.Done()
        fmt.Printf("–í–æ—Ä–∫–µ—Ä %d –∑–∞–≤–µ—Ä—à—ë–Ω\n", id)
        time.Sleep(time.Duration(id) * time.Second)
    }(i)
}

wg.Wait()
fmt.Println("–í—Å–µ –≥–æ—Ä—É—Ç–∏–Ω—ã –∑–∞–≤–µ—Ä—à–∏–ª–∏—Å—å")
```

### **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –ø–∞—Ä–∞–ª–ª–µ–ª–∏–∑–º–∞ —Å–µ–º–∞—Ñ–æ—Ä–æ–º**
–ë—É—Ñ–µ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–π –∫–∞–Ω–∞–ª –∫–∞–∫ —Å—á—ë—Ç—á–∏–∫ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∑–∞–¥–∞—á.

```go
sem := make(chan struct{}, 10)  // –º–∞–∫—Å–∏–º—É–º 10 –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ

for _, task := range tasks {
    sem <- struct{}{}  // –∑–∞—Ö–≤–∞—Ç—ã–≤–∞–µ–º —Å–ª–æ—Ç
    go func(task Task) {
        defer func() { <-sem }()  // –æ—Å–≤–æ–±–æ–∂–¥–∞–µ–º —Å–ª–æ—Ç
        process(task)
    }(task)
}
```

#### –ö–∞–∫–∏–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —á–∞—â–µ –≤—Å–µ–≥–æ
- **Worker Pool** ‚Äî –¥–ª—è –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–≥–æ –ø–∞—Ä–∞–ª–ª–µ–ª–∏–∑–º–∞.
- **Pipeline** ‚Äî –¥–ª—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö.
- **Fan-out/Fan-in** ‚Äî –¥–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π —Å–∫–æ—Ä–æ—Å—Ç–∏ –Ω–∞ –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã—Ö –∑–∞–¥–∞—á–∞—Ö.
- **WaitGroup** ‚Äî –∫–æ–≥–¥–∞ –ø—Ä–æ—Å—Ç–æ –Ω—É–∂–Ω–æ –¥–æ–∂–¥–∞—Ç—å—Å—è –≤—Å–µ—Ö.



## –õ—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏

1. **–ù–µ —Å–æ–∑–¥–∞–≤–∞–π—Ç–µ –≥–æ–Ω–∫—É –¥–∞–Ω–Ω—ã—Ö** ‚Äî –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–∞–Ω–∞–ª—ã –≤–º–µ—Å—Ç–æ –æ–±—â–µ–π –ø–∞–º—è—Ç–∏.
2. **–ó–∞–∫—Ä—ã–≤–∞–π—Ç–µ –∫–∞–Ω–∞–ª—ã** —Ç–æ–ª—å–∫–æ –Ω–∞ —Å—Ç–æ—Ä–æ–Ω–µ –æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—è.
3. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `defer wg.Done()`** –≤ –≥–æ—Ä—É—Ç–∏–Ω–∞—Ö.
4. **–ë—É—Ñ–µ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –∫–∞–Ω–∞–ª—ã** ‚Äî –¥–ª—è –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è —Å–∫–æ—Ä–æ—Å—Ç–∏ (rate limiting).
