---
sidebar_position: 6
description: "–ü—Ä–∞–∫—Ç–∏–∫–∞ –ø–æ –æ–∫–æ–Ω–Ω—ã–º —Ñ—É–Ω–∫—Ü–∏—è–º: —Ä–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–∏–µ, —Å–º–µ—â–µ–Ω–∏–µ, running totals, moving averages"
---

import { RandomVariantButton, TaskWithVariants, CodeBlockPostgres } from "../../src/components/practicModules/practic";

# –ü—Ä–∞–∫—Ç–∏–∫–∞: –û–∫–æ–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ 

<CodeBlockPostgres />

## –ó–∞–¥–∞–Ω–∏–µ 1 ‚Äî –†–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–∏–µ (ROW_NUMBER, RANK, DENSE_RANK)

<TaskWithVariants
  taskId="window-1-ranking"
  title="–ó–∞–¥–∞–Ω–∏–µ 1: –†–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ —Ç–æ–ø-N –≤ –≥—Ä—É–ø–ø–∞—Ö"
  difficulty={["–õ—ë–≥–∫–∏–π","–õ—ë–≥–∫–∏–π","–õ—ë–≥–∫–∏–π","–õ—ë–≥–∫–∏–π","–õ—ë–≥–∫–∏–π","–õ—ë–≥–∫–∏–π","–õ—ë–≥–∫–∏–π","–õ—ë–≥–∫–∏–π","–õ—ë–≥–∫–∏–π","–õ—ë–≥–∫–∏–π"]}
  estimatedTime="15-25 –º–∏–Ω—É—Ç"
  description="–ò—Å–ø–æ–ª—å–∑—É–π ROW_NUMBER, RANK, DENSE_RANK –¥–ª—è –Ω—É–º–µ—Ä–∞—Ü–∏–∏ –∏ –≤—ã–±–æ—Ä–∞ —Ç–æ–ø-N."
  variants={[
    "–¢–æ–ø-5 –ø—Ä–æ–¥–∞–≤—Ü–æ–≤ –ø–æ –æ–±—â–µ–π –≤—ã—Ä—É—á–∫–µ",
    "–¢–æ–ø-3 –ø—Ä–æ–¥—É–∫—Ç–∞ –≤ –∫–∞–∂–¥–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –ø—Ä–æ–¥–∞–∂",
    "–†–∞–Ω–≥ –∑–∞—Ä–ø–ª–∞—Ç –≤–Ω—É—Ç—Ä–∏ –∫–∞–∂–¥–æ–≥–æ –æ—Ç–¥–µ–ª–∞ (—Å—Ä–∞–≤–Ω–∏ RANK –∏ DENSE_RANK)",
    "–ü–∞–≥–∏–Ω–∞—Ü–∏—è –ø—Ä–æ–¥–∞–∂: –ø–æ–∫–∞–∑–∞—Ç—å –∑–∞–ø–∏—Å–∏ 21‚Äì40",
    "–ù—É–º–µ—Ä–∞—Ü–∏—è –ø—Ä–æ–¥–∞–∂ –∫–∞–∂–¥–æ–≥–æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ –ø–æ –¥–∞—Ç–µ (—Å–∞–º–∞—è —Å–≤–µ–∂–∞—è = 1)",
    "–†–µ–π—Ç–∏–Ω–≥ —Ä–µ–≥–∏–æ–Ω–æ–≤ –ø–æ –≤—ã—Ä—É—á–∫–µ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–π –º–µ—Å—è—Ü",
    "–¢–æ–ø-2 —Å–∞–º—ã—Ö –¥–æ—Ä–æ–≥–∏—Ö –ø—Ä–æ–¥–∞–∂–∏ –∫–∞–∂–¥–æ–≥–æ –ø—Ä–æ–¥—É–∫—Ç–∞",
    "–†–∞–Ω–≥ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –ø–æ –¥–∞—Ç–µ –Ω–∞–π–º–∞ –≤–Ω—É—Ç—Ä–∏ –æ—Ç–¥–µ–ª–∞",
    "ABC-–∞–Ω–∞–ª–∏–∑ –ø—Ä–æ–¥—É–∫—Ç–æ–≤ –ø–æ –≤—ã—Ä—É—á–∫–µ (NTILE + RANK)",
    "–†–∞–Ω–≥ –ø—Ä–æ–¥–∞–≤—Ü–æ–≤ –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É —Å–¥–µ–ª–æ–∫ –≤ –∫–∞–∂–¥–æ–º –º–µ—Å—è—Ü–µ",
    "–¢–æ–ø-10% —Å–∞–º—ã—Ö –ø—Ä–∏–±—ã–ª—å–Ω—ã—Ö –ø—Ä–æ–¥—É–∫—Ç–æ–≤ (NTILE)",
    "–†–∞–Ω–≥ –∑–∞—Ä–ø–ª–∞—Ç –ø–æ –≤—Å–µ–π –∫–æ–º–ø–∞–Ω–∏–∏ + –∫–≤–∞—Ä—Ç–∏–ª–∏ (NTILE)"
  ]}
>

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:**
- –º–∏–Ω–∏–º—É–º 2 —Ä–∞–∑–Ω—ã—Ö —Ä–∞–Ω–∂–∏—Ä—É—é—â–∏—Ö —Ñ—É–Ω–∫—Ü–∏–∏
- —Ö–æ—Ç—è –±—ã –æ–¥–∏–Ω –∑–∞–ø—Ä–æ—Å —Å PARTITION BY
- —Ö–æ—Ç—è –±—ã –æ–¥–∏–Ω —Ç–æ–ø-N (WHERE rank &le;  3 / row_number &le;  10)
- –∫—Ä–∞—Å–∏–≤–æ–µ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ (–∏–º—è, —Å—É–º–º–∞, —Ä–∞–Ω–≥)

–ü—Ä–∏–º–µ—Ä:
```sql
WITH ranked_products AS (
    SELECT
        p.category,
        p.product_name,
        SUM(s.quantity * s.unit_price) AS revenue,
        RANK() OVER (PARTITION BY p.category ORDER BY SUM(s.quantity * s.unit_price) DESC) AS rank
    FROM products p
    LEFT JOIN sales s ON p.product_id = s.product_id
    GROUP BY p.category, p.product_name
)
SELECT * FROM ranked_products
WHERE rank <= 3
ORDER BY category, rank;
```
</TaskWithVariants>

## –ó–∞–¥–∞–Ω–∏–µ 2 ‚Äî –°–º–µ—â–µ–Ω–∏–µ (LAG, LEAD, FIRST_VALUE, LAST_VALUE)

<TaskWithVariants
  taskId="window-2-offset"
  title="–ó–∞–¥–∞–Ω–∏–µ 2: –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –ø—Ä–µ–¥—ã–¥—É—â–∏–º–∏/—Å–ª–µ–¥—É—é—â–∏–º–∏ —Å—Ç—Ä–æ–∫–∞–º–∏"
  difficulty={["–°—Ä–µ–¥–Ω–∏–π","–°—Ä–µ–¥–Ω–∏–π","–°—Ä–µ–¥–Ω–∏–π","–°—Ä–µ–¥–Ω–∏–π","–°—Ä–µ–¥–Ω–∏–π","–°—Ä–µ–¥–Ω–∏–π","–°—Ä–µ–¥–Ω–∏–π","–°—Ä–µ–¥–Ω–∏–π","–°—Ä–µ–¥–Ω–∏–π","–°—Ä–µ–¥–Ω–∏–π"]}
  estimatedTime="20-35 –º–∏–Ω—É—Ç"
  description="–ò—Å–ø–æ–ª—å–∑—É–π LAG/LEAD –¥–ª—è —Ä–∞—Å—á—ë—Ç–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π, —Ä–∞–∑–Ω–∏—Ü, —Ç—Ä–µ–Ω–¥–æ–≤."
  variants={[
    "–ò–∑–º–µ–Ω–µ–Ω–∏–µ –¥–Ω–µ–≤–Ω–æ–π –≤—ã—Ä—É—á–∫–∏ –¥–µ–Ω—å –∫ –¥–Ω—é (+Œî –∏ %)",
    "–î–Ω–µ–π —Å –ø–æ—Å–ª–µ–¥–Ω–µ–π –ø—Ä–æ–¥–∞–∂–∏ –∫–∞–∂–¥–æ–≥–æ –ø—Ä–æ–¥—É–∫—Ç–∞",
    "–°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–π –∑–∞—Ä–ø–ª–∞—Ç—ã —Å –ø—Ä–µ–¥—ã–¥—É—â–µ–π –≤ –æ—Ç–¥–µ–ª–µ",
    "–ü–µ—Ä–≤–∞—è –∏ –ø–æ—Å–ª–µ–¥–Ω—è—è –ø—Ä–æ–¥–∞–∂–∞ –∫–∞–∂–¥–æ–≥–æ –ø—Ä–æ–¥—É–∫—Ç–∞",
    "–¢—Ä–µ–Ω–¥ –ø—Ä–æ–¥–∞–∂: —Ä–æ—Å—Ç/—Å–ø–∞–¥/–ø–∏–∫/–¥–Ω–æ –ø–æ –¥–Ω—è–º",
    "–†–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É —Å–∞–º–æ–π –≤—ã—Å–æ–∫–æ–π –∏ —Ç–µ–∫—É—â–µ–π —Ü–µ–Ω–æ–π –ø—Ä–æ–¥–∞–∂–∏ –ø—Ä–æ–¥—É–∫—Ç–∞",
    "–°–∫–æ–ª—å–∫–æ –¥–Ω–µ–π –ø—Ä–æ—à–ª–æ —Å –ø—Ä–µ–¥—ã–¥—É—â–µ–π –ø—Ä–æ–¥–∞–∂–∏ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞",
    "–°—Ä–∞–≤–Ω–µ–Ω–∏–µ –≤—ã—Ä—É—á–∫–∏ –º–µ—Å—è—Ü–∞ —Å –ø—Ä–µ–¥—ã–¥—É—â–∏–º –º–µ—Å—è—Ü–µ–º",
    "–ü–µ—Ä–≤–∞—è –ø—Ä–æ–¥–∞–∂–∞ –∫–∞–∂–¥–æ–≥–æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ + —Å–∫–æ–ª—å–∫–æ –æ–Ω –ø—Ä–æ–¥–∞–ª —Å —Ç–µ—Ö –ø–æ—Ä",
    "–î–∏–Ω–∞–º–∏–∫–∞ —Ü–µ–Ω—ã –ø—Ä–æ–¥—É–∫—Ç–∞: –∏–∑–º–µ–Ω–µ–Ω–∏–µ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –ø–µ—Ä–≤–æ–π –ø—Ä–æ–¥–∞–∂–∏",
    "LEAD: –ø—Ä–æ–≥–Ω–æ–∑ ‚Äî –≤—ã—Ä—É—á–∫–∞ —Å–ª–µ–¥—É—é—â–µ–≥–æ –¥–Ω—è/–Ω–µ–¥–µ–ª–∏",
    "LAG + LEAD: –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ª–æ–∫–∞–ª—å–Ω—ã—Ö –º–∞–∫—Å–∏–º—É–º–æ–≤/–º–∏–Ω–∏–º—É–º–æ–≤"
  ]}
>

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:**
- –º–∏–Ω–∏–º—É–º LAG –∏–ª–∏ LEAD
- —Ä–∞—Å—á—ë—Ç –ø—Ä–æ—Ü–µ–Ω—Ç–Ω–æ–≥–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∏–ª–∏ —Ä–∞–∑–Ω–∏—Ü—ã
- –æ–±—Ä–∞–±–æ—Ç–∫–∞ NULL (COALESCE, NULLIF)
- —Ö–æ—Ç—è –±—ã –æ–¥–∏–Ω –∑–∞–ø—Ä–æ—Å —Å FIRST_VALUE / LAST_VALUE

–ü—Ä–∏–º–µ—Ä:
```sql
SELECT
    sale_date,
    daily_revenue,
    LAG(daily_revenue) OVER (ORDER BY sale_date) AS prev_day,
    daily_revenue - LAG(daily_revenue) OVER (ORDER BY sale_date) AS delta,
    ROUND(
        (daily_revenue - LAG(daily_revenue) OVER (ORDER BY sale_date)) /
        NULLIF(LAG(daily_revenue) OVER (ORDER BY sale_date), 0) * 100,
        2
    ) AS pct_change
FROM (
    SELECT sale_date, SUM(quantity * unit_price) AS daily_revenue
    FROM sales
    GROUP BY sale_date
) t
ORDER BY sale_date;
```
</TaskWithVariants>

## –ó–∞–¥–∞–Ω–∏–µ 3 ‚Äî –ù–∞–∫–æ–ø–∏—Ç–µ–ª—å–Ω—ã–µ —Å—É–º–º—ã –∏ —Å–∫–æ–ª—å–∑—è—â–∏–µ —Å—Ä–µ–¥–Ω–∏–µ

<TaskWithVariants
  taskId="window-3-running"
  title="–ó–∞–¥–∞–Ω–∏–µ 3: Running totals, moving averages, –∫—É–º—É–ª—è—Ç–∏–≤–Ω—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏"
  difficulty={["–°—Ä–µ–¥–Ω–∏–π","–°—Ä–µ–¥–Ω–∏–π","–°—Ä–µ–¥–Ω–∏–π","–°—Ä–µ–¥–Ω–∏–π","–°—Ä–µ–¥–Ω–∏–π","–°—Ä–µ–¥–Ω–∏–π","–°—Ä–µ–¥–Ω–∏–π","–°—Ä–µ–¥–Ω–∏–π","–°—Ä–µ–¥–Ω–∏–π","–°—Ä–µ–¥–Ω–∏–π"]}
  estimatedTime="25-40 –º–∏–Ω—É—Ç"
  description="–†–∞–±–æ—Ç–∞ —Å –Ω–∞–∫–æ–ø–∏—Ç–µ–ª—å–Ω—ã–º–∏ —Å—É–º–º–∞–º–∏ –∏ —Å–∫–æ–ª—å–∑—è—â–∏–º–∏ –æ–∫–Ω–∞–º–∏."
  variants={[
    "–ù–∞–∫–æ–ø–∏—Ç–µ–ª—å–Ω–∞—è –≤—ã—Ä—É—á–∫–∞ –ø–æ –¥–Ω—è–º (running total)",
    "–ü—Ä–æ—Ü–µ–Ω—Ç –æ—Ç –æ–±—â–µ–π –≤—ã—Ä—É—á–∫–∏ –Ω–∞—Ä–∞—Å—Ç–∞—é—â–∏–º –∏—Ç–æ–≥–æ–º",
    "–°–∫–æ–ª—å–∑—è—â–µ–µ —Å—Ä–µ–¥–Ω–µ–µ –≤—ã—Ä—É—á–∫–∏ –∑–∞ 7 –¥–Ω–µ–π",
    "–ù–∞–∫–æ–ø–∏—Ç–µ–ª—å–Ω–∞—è —Å—É–º–º–∞ –ø—Ä–æ–¥–∞–∂ –ø–æ –∫–∞–∂–¥–æ–º—É –ø—Ä–æ–¥—É–∫—Ç—É –æ—Ç–¥–µ–ª—å–Ω–æ",
    "–î–æ–ª—è –∫–∞–∂–¥–æ–≥–æ –¥–Ω—è –≤ –º–µ—Å—è—á–Ω–æ–π –≤—ã—Ä—É—á–∫–µ + –∫—É–º—É–ª—è—Ç–∏–≤–Ω—ã–π %",
    "–°–∫–æ–ª—å–∑—è—â–µ–µ —Å—Ä–µ–¥–Ω–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –ø—Ä–æ–¥–∞–Ω–Ω—ã—Ö –µ–¥–∏–Ω–∏—Ü –∑–∞ 14 –¥–Ω–µ–π",
    "–ù–∞–∫–æ–ø–∏—Ç–µ–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ–¥–∞–Ω–Ω—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º",
    "–°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å–∫–æ–ª—å–∑—è—â–µ–≥–æ —Å—Ä–µ–¥–Ω–µ–≥–æ 7–¥ vs 30–¥",
    "Running total –∑–∞—Ä–ø–ª–∞—Ç–Ω–æ–≥–æ —Ñ–æ–Ω–¥–∞ –ø–æ –æ—Ç–¥–µ–ª–∞–º",
    "–ö—É–º—É–ª—è—Ç–∏–≤–Ω–∞—è –≤—ã—Ä—É—á–∫–∞ –ø–æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞–º (–∫—Ç–æ –ø—Ä–∏–Ω—ë—Å –±–æ–ª—å—à–µ –≤—Å–µ–≥–æ —Å–æ –≤—Ä–µ–º–µ–Ω–µ–º)",
    "–°–∫–æ–ª—å–∑—è—â–µ–µ —Å—Ä–µ–¥–Ω–µ–µ —Ü–µ–Ω—ã –ø—Ä–æ–¥–∞–∂–∏ –ø—Ä–æ–¥—É–∫—Ç–∞ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 10 –ø—Ä–æ–¥–∞–∂",
    "–ù–∞–∫–æ–ø–∏—Ç–µ–ª—å–Ω–∞—è –º–∞—Ä–∂–∞ (revenue - cost) –ø–æ –ø—Ä–æ–¥—É–∫—Ç–∞–º"
  ]}
>

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:**
- SUM() / AVG() OVER —Å ORDER BY
- —Ö–æ—Ç—è –±—ã –æ–¥–Ω–æ —Å–∫–æ–ª—å–∑—è—â–µ–µ –æ–∫–Ω–æ (ROWS BETWEEN ‚Ä¶ PRECEDING AND CURRENT ROW)
- –∫—Ä–∞—Å–∏–≤–æ–µ –æ–∫—Ä—É–≥–ª–µ–Ω–∏–µ + % –≥–¥–µ —É–º–µ—Å—Ç–Ω–æ

–ü—Ä–∏–º–µ—Ä:
```sql
SELECT
    sale_date,
    daily_revenue,
    SUM(daily_revenue) OVER (ORDER BY sale_date) AS running_total,
    ROUND(
        SUM(daily_revenue) OVER (ORDER BY sale_date) /
        SUM(daily_revenue) OVER () * 100,
        2
    ) AS cumulative_pct
FROM (
    SELECT sale_date, SUM(quantity * unit_price) AS daily_revenue
    FROM sales
    GROUP BY sale_date
) t
ORDER BY sale_date;
```
</TaskWithVariants>

## –ó–∞–¥–∞–Ω–∏–µ 4 ‚Äî –ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–µ –∑–∞–ø—Ä–æ—Å—ã

<TaskWithVariants
  taskId="window-4-advanced"
  title="–ó–∞–¥–∞–Ω–∏–µ 4: –ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –æ–∫–æ–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏"
  difficulty={["–°–ª–æ–∂–Ω—ã–π","–°–ª–æ–∂–Ω—ã–π","–°–ª–æ–∂–Ω—ã–π","–°–ª–æ–∂–Ω—ã–π","–°–ª–æ–∂–Ω—ã–π","–°–ª–æ–∂–Ω—ã–π","–°–ª–æ–∂–Ω—ã–π","–°–ª–æ–∂–Ω—ã–π","–°–ª–æ–∂–Ω—ã–π","–°–ª–æ–∂–Ω—ã–π"]}
  estimatedTime="35-60 –º–∏–Ω—É—Ç"
  description="–°–º–µ—à–∏–≤–∞–π —Ä–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–∏–µ, —Å–º–µ—â–µ–Ω–∏–µ –∏ –∞–≥—Ä–µ–≥–∞—Ç—ã –≤ –æ–¥–Ω–æ–º –∑–∞–ø—Ä–æ—Å–µ."
  variants={[
    "–¢–æ–ø-3 –ø—Ä–æ–¥—É–∫—Ç–∞ –ø–æ –≤—ã—Ä—É—á–∫–µ + –∏–∑–º–µ–Ω–µ–Ω–∏–µ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ –º–µ—Å—è—Ü–∞",
    "–°–æ—Ç—Ä—É–¥–Ω–∏–∫–∏ + —Ä–∞–Ω–≥ –ø–æ –≤—ã—Ä—É—á–∫–µ + —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –ø—Ä–µ–¥—ã–¥—É—â–∏–º –º–µ—Å—è—Ü–µ–º",
    "–ü—Ä–æ–¥—É–∫—Ç—ã + ABC-–∫–ª–∞—Å—Å + running total –≤–Ω—É—Ç—Ä–∏ –∫–ª–∞—Å—Å–∞",
    "–î–∏–Ω–∞–º–∏–∫–∞ –ø—Ä–æ–¥–∞–∂ –ø–æ —Ä–µ–≥–∏–æ–Ω–∞–º + —Ä–∞–Ω–≥ —Ä–µ–≥–∏–æ–Ω–∞ –∫–∞–∂–¥—ã–π –º–µ—Å—è—Ü",
    "–°–∫–æ–ª—å–∑—è—â–µ–µ —Å—Ä–µ–¥–Ω–µ–µ + –≤—ã—è–≤–ª–µ–Ω–∏–µ –∞–Ω–æ–º–∞–ª–∏–π (–≤—ã—à–µ 2√ó —Å—Ä–µ–¥–Ω–µ–≥–æ)",
    "–†–µ–π—Ç–∏–Ω–≥ –ø—Ä–æ–¥–∞–≤—Ü–æ–≤ + –∏—Ö –ª–∏—á–Ω—ã–π running total + –¥–æ–ª—è –æ—Ç –∫–æ–º–∞–Ω–¥—ã",
    "–ü—Ä–æ–¥—É–∫—Ç—ã + —Ä–∞–Ω–≥ –≤ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ + –¥–Ω–µ–π —Å –ø–æ—Å–ª–µ–¥–Ω–µ–π –ø—Ä–æ–¥–∞–∂–∏",
    "–ú–µ—Å—è—á–Ω–∞—è –≤—ã—Ä—É—á–∫–∞ + —Å–∫–æ–ª—å–∑—è—â–µ–µ —Å—Ä–µ–¥–Ω–µ–µ + —Ç—Ä–µ–Ω–¥ (—Ä–æ—Å—Ç/–ø–∞–¥–µ–Ω–∏–µ)",
    "–°–æ—Ç—Ä—É–¥–Ω–∏–∫–∏ + –∫–≤–∞—Ä—Ç–∏–ª—å –∑–∞—Ä–ø–ª–∞—Ç—ã + —Å—Ä–µ–¥–Ω—è—è –∑–∞—Ä–ø–ª–∞—Ç–∞ –≤ –∫–≤–∞—Ä—Ç–∏–ª–µ",
    "–ü—Ä–æ–¥–∞–∂–∏ + —Ä–∞–Ω–≥ –≤–Ω—É—Ç—Ä–∏ –º–µ—Å—è—Ü–∞ + –º–µ–¥–∏–∞–Ω–∞ –≤—ã—Ä—É—á–∫–∏ –º–µ—Å—è—Ü–∞",
    "–ö–∞—Ç–µ–≥–æ—Ä–∏–∏ + —Ç–æ–ø-–ø—Ä–æ–¥—É–∫—Ç + –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Ü–µ–Ω—ã –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –ø–µ—Ä–≤–æ–≥–æ –∑–∞–ø—É—Å–∫–∞",
    "Running total –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º + % –æ—Ç –æ–±—â–µ–π –∫—É–º—É–ª—è—Ç–∏–≤–Ω–æ–π –≤—ã—Ä—É—á–∫–∏"
  ]}
>

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:**
- –º–∏–Ω–∏–º—É–º 3 —Ä–∞–∑–Ω—ã—Ö –æ–∫–æ–Ω–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–∏ –≤ –æ–¥–Ω–æ–º –∑–∞–ø—Ä–æ—Å–µ
- CTE –¥–ª—è –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã—Ö –≤—ã—á–∏—Å–ª–µ–Ω–∏–π
- –æ—Å–º—ã—Å–ª–µ–Ω–Ω—ã–µ –∏–º–µ–Ω–∞ —Å—Ç–æ–ª–±—Ü–æ–≤
- —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –∏ LIMIT –≥–¥–µ –Ω—É–∂–Ω–æ

–ü—Ä–∏–º–µ—Ä —Å—Ç—Ä—É–∫—Ç—É—Ä—ã:
```sql
WITH monthly AS (
    SELECT DATE_TRUNC('month', sale_date) AS month, ...
),
ranked AS (
    SELECT ..., RANK() OVER (...) AS rank, LAG(...) OVER (...)
    FROM monthly
)
SELECT ..., moving_avg, pct_change
FROM ranked
ORDER BY month DESC, rank;
```
</TaskWithVariants>

## –ó–∞–¥–∞–Ω–∏–µ 5 ‚Äî –ò—Ç–æ–≥–æ–≤—ã–π –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–π –¥–∞—à–±–æ—Ä–¥

<TaskWithVariants
  taskId="window-5-final"
  title="–ó–∞–¥–∞–Ω–∏–µ 5: –ü–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–π –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–π –æ—Ç—á—ë—Ç (–∏—Ç–æ–≥–æ–≤–æ–µ)"
  difficulty={["–°–ª–æ–∂–Ω—ã–π","–°–ª–æ–∂–Ω—ã–π","–°–ª–æ–∂–Ω—ã–π","–°–ª–æ–∂–Ω—ã–π","–°–ª–æ–∂–Ω—ã–π","–°–ª–æ–∂–Ω—ã–π","–°–ª–æ–∂–Ω—ã–π","–°–ª–æ–∂–Ω—ã–π","–°–ª–æ–∂–Ω—ã–π","–°–ª–æ–∂–Ω—ã–π"]}
  estimatedTime="60-120 –º–∏–Ω—É—Ç"
  description="–°–æ–∑–¥–∞–π –æ—Ç—á—ë—Ç —É—Ä–æ–≤–Ω—è BI-–¥–∞—à–±–æ—Ä–¥–∞ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Ç–æ–ª—å–∫–æ –æ–∫–æ–Ω–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π."
  variants={[
    "–ü—Ä–æ–¥–∞–∂–∏: –¥–∏–Ω–∞–º–∏–∫–∞, —Ç–æ–ø-–ø—Ä–æ–¥—É–∫—Ç—ã, —Ç—Ä–µ–Ω–¥—ã, —Ä–µ–≥–∏–æ–Ω—ã",
    "–°–æ—Ç—Ä—É–¥–Ω–∏–∫–∏ –ø—Ä–æ–¥–∞–∂: KPI, —Ä–∞–Ω–≥, –¥–∏–Ω–∞–º–∏–∫–∞, —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –∫–æ–º–∞–Ω–¥–æ–π",
    "–ü—Ä–æ–¥—É–∫—Ç—ã: ABC/XYZ –∞–Ω–∞–ª–∏–∑, –∂–∏–∑–Ω–µ–Ω–Ω—ã–π —Ü–∏–∫–ª, –º–∞—Ä–∂–∏–Ω–∞–ª—å–Ω–æ—Å—Ç—å",
    "–ö–∞—Ç–µ–≥–æ—Ä–∏–∏ —Ç–æ–≤–∞—Ä–æ–≤: —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –≤—ã—Ä—É—á–∫–∏, —Ç–æ–ø-–ø–æ–∑–∏—Ü–∏–∏, —Å–µ–∑–æ–Ω–Ω–æ—Å—Ç—å",
    "–†–µ–≥–∏–æ–Ω–∞–ª—å–Ω—ã–π –æ—Ç—á—ë—Ç: –¥–æ–ª–∏ —Ä—ã–Ω–∫–∞, —Ä–æ—Å—Ç, –ª–∏–¥–µ—Ä—ã –ø–æ –º–µ—Å—è—Ü–∞–º",
    "–í—Ä–µ–º–µ–Ω–Ω–æ–π –∞–Ω–∞–ª–∏–∑: —Å–∫–æ–ª—å–∑—è—â–∏–µ –º–µ—Ç—Ä–∏–∫–∏, –∞–Ω–æ–º–∞–ª–∏–∏, –ø—Ä–æ–≥–Ω–æ–∑ —Ç—Ä–µ–Ω–¥–∞",
    "–°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø—Ä–æ–¥–∞–≤—Ü–æ–≤: –ª–∏—á–Ω—ã–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è + –≤–∫–ª–∞–¥ –≤ –∫–æ–º–∞–Ω–¥—É",
    "–ü—Ä–æ–¥—É–∫—Ç–æ–≤–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞: —Ü–µ–Ω–∞, –æ—Å—Ç–∞—Ç–∫–∏, —Å–∫–æ—Ä–æ—Å—Ç—å –ø—Ä–æ–¥–∞–∂, –≤–æ–∑–≤—Ä–∞—Ç—ã",
    "–§–∏–Ω–∞–Ω—Å–æ–≤—ã–π —Å—Ä–µ–∑: –º–∞—Ä–∂–∞, –∫—É–º—É–ª—è—Ç–∏–≤–Ω–∞—è –ø—Ä–∏–±—ã–ª—å, —Ç–æ–ø –ø–æ ROI",
    "HR + –ø—Ä–æ–¥–∞–∂–∏: —Å–≤—è–∑—å —Å—Ç–∞–∂–∞/–∑–∞—Ä–ø–ª–∞—Ç—ã —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏",
    "–ú–µ—Å—è—á–Ω—ã–π –¥–∞—à–±–æ—Ä–¥: –∫–ª—é—á–µ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏ + —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –ø—Ä–æ—à–ª—ã–º –º–µ—Å—è—Ü–µ–º",
    "–ü–æ–ª–Ω—ã–π –ø—Ä–æ–¥—É–∫—Ç–æ–≤—ã–π –æ—Ç—á—ë—Ç: –æ—Ç –∑–∞–ø—É—Å–∫–∞ –¥–æ —Ç–µ–∫—É—â–µ–π –¥–∏–Ω–∞–º–∏–∫–∏"
  ]}
>

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:**
- 5‚Äì8 —Ä–∞–∑–Ω—ã—Ö –æ–∫–æ–Ω–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π
- –Ω–µ—Å–∫–æ–ª—å–∫–æ CTE
- –∫–æ–º–±–∏–Ω–∞—Ü–∏—è —Ä–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–∏—è + —Å–º–µ—â–µ–Ω–∏—è + running / moving
- –∫—Ä–∞—Å–∏–≤–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (ROUND, TO_CHAR, CASE –¥–ª—è –º–µ—Ç–æ–∫)
- –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å —É—Å–ª–æ–≤–Ω–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (ü•á ü•à ü•â, ‚ñ≤ ‚ñº)
- —Ä–µ–∑—É–ª—å—Ç–∞—Ç –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –ø–æ–Ω—è—Ç–µ–Ω –º–µ–Ω–µ–¥–∂–µ—Ä—É –±–µ–∑ –≥–ª—É–±–æ–∫–æ–≥–æ –∑–Ω–∞–Ω–∏—è SQL

–≠—Ç–æ –∑–∞–¥–∞–Ω–∏–µ ‚Äî –æ—Ç–ª–∏—á–Ω—ã–π –∫–∞–Ω–¥–∏–¥–∞—Ç –¥–ª—è –ø–æ—Ä—Ç—Ñ–æ–ª–∏–æ –∏–ª–∏ –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏ –Ω–∞–≤—ã–∫–æ–≤ –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–æ–≥–æ SQL.
</TaskWithVariants>

:::tip
–û–∫–æ–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ ‚Äî —ç—Ç–æ –∫–æ–≥–¥–∞ —Ç—ã –Ω–∞—á–∏–Ω–∞–µ—à—å –¥—É–º–∞—Ç—å –∫–∞–∫ –∞–Ω–∞–ª–∏—Ç–∏–∫, –∞ –Ω–µ –∫–∞–∫ –∞–≥—Ä–µ–≥–∞—Ç–æ—Ä.  
–ì–ª–∞–≤–Ω—ã–µ —Å–µ–∫—Ä–µ—Ç—ã —É—Å–ø–µ—Ö–∞:
1. –í—Å–µ–≥–¥–∞ –¥—É–º–∞–π –ø—Ä–æ PARTITION BY –∏ ORDER BY
2. –î–ª—è —Å–∫–æ–ª—å–∑—è—â–∏—Ö –æ–∫–æ–Ω –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ —É–∫–∞–∑—ã–≤–∞–π frame (ROWS / RANGE)
3. –ö–æ–º–±–∏–Ω–∏—Ä—É–π –Ω–µ—Å–∫–æ–ª—å–∫–æ –æ–∫–æ–Ω–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π –≤ –æ–¥–Ω–æ–º SELECT ‚Äî —ç—Ç–æ –º–∞–≥–∏—è
4. CTE –¥–µ–ª–∞–µ—Ç –∫–æ–¥ —á–∏—Ç–∞–µ–º—ã–º ‚Äî –Ω–µ –±–æ–π—Å—è –∏—Ö –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å
:::
