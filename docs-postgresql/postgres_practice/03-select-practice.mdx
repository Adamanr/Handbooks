---
sidebar_position: 3
description: "–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –∑–∞–¥–∞–Ω–∏—è –ø–æ —Å–ª–æ–∂–Ω—ã–º SELECT-–∑–∞–ø—Ä–æ—Å–∞–º: JOIN, –∞–≥—Ä–µ–≥–∞—Ç–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏, FILTER, CTE, LATERAL, DISTINCT ON, UNION/INTERSECT/EXCEPT."
---

# –ü—Ä–∞–∫—Ç–∏–∫–∞: –°–ª–æ–∂–Ω—ã–µ SELECT-–∑–∞–ø—Ä–æ—Å—ã

import { RandomVariantButton, TaskWithVariants } from "../../src/components/practicModules/practic";

–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –∑–∞–¥–∞–Ω–∏—è –Ω–∞ —Ä–∞–±–æ—Ç—É —Å –±–∞–∑–æ–π —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç–∞ (students, professors, courses, enrollments, exams, exam_results).  
–í—Å–µ —Ç–∞–±–ª–∏—Ü—ã –∏ –¥–∞–Ω–Ω—ã–µ —É–∂–µ —Å–æ–∑–¥–∞–Ω—ã –ø–æ –ª–µ–∫—Ü–∏–∏.

## –ó–∞–¥–∞–Ω–∏–µ 1: INNER JOIN + –±–∞–∑–æ–≤—ã–µ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏—è
<TaskWithVariants
  title="–ó–∞–¥–∞–Ω–∏–µ 1: –°—Ç—É–¥–µ–Ω—Ç—ã –∏ –∏—Ö –∫—É—Ä—Å—ã"
  description="–°–æ–µ–¥–∏–Ω–∏—Ç–µ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ —Å –∫—É—Ä—Å–∞–º–∏, –Ω–∞ –∫–æ—Ç–æ—Ä—ã–µ –æ–Ω–∏ –∑–∞–ø–∏—Å–∞–Ω—ã."
  variants={[
    <><p>–¢–æ–ª—å–∫–æ —Å –æ—Ü–µ–Ω–∫–∞–º–∏</p></>,
    <><p>–¢–æ–ª—å–∫–æ –∞–∫—Ç–∏–≤–Ω—ã–µ –∑–∞–ø–∏—Å–∏</p></>,
    <><p>–° —É–∫–∞–∑–∞–Ω–∏–µ–º –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—è</p></>,
  ]}
>
  <details>
    <summary>–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è</summary>
    <ul>
      <li>–í—ã–±–µ—Ä–∏—Ç–µ –∏–º—è –∏ —Ñ–∞–º–∏–ª–∏—é —Å—Ç—É–¥–µ–Ω—Ç–∞, –Ω–∞–∑–≤–∞–Ω–∏–µ –∫—É—Ä—Å–∞, –æ—Ü–µ–Ω–∫—É (grade)</li>
      <li>–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ INNER JOIN –º–µ–∂–¥—É students –∏ enrollments –∏ courses</li>
      <li>–î–æ–±–∞–≤—å—Ç–µ —É—Å–ª–æ–≤–∏–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è –ø–æ –≤–∞—Ä–∏–∞–Ω—Ç—É</li>
      <li>–í—ã–≤–µ–¥–∏—Ç–µ –Ω–µ –º–µ–Ω–µ–µ 5 —Å—Ç—Ä–æ–∫</li>
      <li>–û—Ç—Å–æ—Ä—Ç–∏—Ä—É–π—Ç–µ –ø–æ —Ñ–∞–º–∏–ª–∏–∏ —Å—Ç—É–¥–µ–Ω—Ç–∞</li>
    </ul>
  </details>
  <details>
      <summary>üí° –ü–æ–¥—Å–∫–∞–∑–∫–∞</summary>
      <p>`students JOIN enrollments ON student_id JOIN courses ON course_id`</p>
  </details>
</TaskWithVariants>

## –ó–∞–¥–∞–Ω–∏–µ 2: LEFT JOIN ‚Äî –∫—Ç–æ –Ω–µ –∑–∞–ø–∏—Å–∞–Ω
<TaskWithVariants
  title="–ó–∞–¥–∞–Ω–∏–µ 2: –°—Ç—É–¥–µ–Ω—Ç—ã –±–µ–∑ –∫—É—Ä—Å–æ–≤"
  description="–ù–∞–π–¥–∏—Ç–µ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –Ω–∏ –Ω–∞ –æ–¥–∏–Ω –∫—É—Ä—Å –Ω–µ –∑–∞–ø–∏—Å–∞–Ω—ã."
  variants={[
    <><p>–í—Å–µ —Å—Ç—É–¥–µ–Ω—Ç—ã + –∫—É—Ä—Å—ã (NULL –µ—Å–ª–∏ –Ω–µ—Ç)</p></>,
    <><p>–¢–æ–ª—å–∫–æ —Ç–µ, —É –∫–æ–≥–æ NULL</p></>,
    <><p>–°—Ç—É–¥–µ–Ω—Ç—ã + –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫—É—Ä—Å–æ–≤</p></>,
  ]}
>
  <details>
    <summary>–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è</summary>
    <ul>
      <li>–í—ã–±–µ—Ä–∏—Ç–µ first_name, last_name, major, city –∏–∑ students</li>
      <li>LEFT JOIN enrollments –∏ courses</li>
      <li>–í—ã–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –∫—É—Ä—Å–∞ –∏–ª–∏ NULL</li>
      <li>–î–æ–±–∞–≤—å—Ç–µ WHERE course_id IS NULL –¥–ª—è –ø–æ–∏—Å–∫–∞ –Ω–µ–∑–∞–ø–∏—Å–∞–Ω–Ω—ã—Ö</li>
      <li>–°–¥–µ–ª–∞–π—Ç–µ –≤—Ç–æ—Ä–æ–π –≤–∞—Ä–∏–∞–Ω—Ç: COUNT(course_id) –∏ GROUP BY student_id</li>
    </ul>
  </details>
</TaskWithVariants>

## –ó–∞–¥–∞–Ω–∏–µ 3: –ê–≥—Ä–µ–≥–∞—Ç—ã + GROUP BY + HAVING
<TaskWithVariants
  title="–ó–∞–¥–∞–Ω–∏–µ 3: –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ—Å—Ç—è–º"
  description="–ê–Ω–∞–ª–∏–∑ —É—Å–ø–µ–≤–∞–µ–º–æ—Å—Ç–∏ –ø–æ –≤–∞–∂–Ω–æ—Å—Ç–∏"
  variants={[
    <><p>–°—Ä–µ–¥–Ω–∏–π GPA –∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ</p></>,
    <><p>–ú–∏–Ω–∏–º—É–º/–º–∞–∫—Å–∏–º—É–º GPA</p></>,
    <><p>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ —Å GPA ‚â• 3.7</p></>,
  ]}
>
  <details>
    <summary>–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è</summary>
    <ul>
      <li>`GROUP BY major`</li>
      <li>`COUNT(*), AVG(gpa), MIN(gpa), MAX(gpa)`</li>
      <li>`HAVING COUNT(*) &gt;= 2`</li>
      <li>`ROUND(AVG(gpa), 2)`</li>
      <li>–û—Ç—Å–æ—Ä—Ç–∏—Ä—É–π—Ç–µ –ø–æ —Å—Ä–µ–¥–Ω–µ–º—É GPA DESC</li>
    </ul>
  </details>
</TaskWithVariants>

## –ó–∞–¥–∞–Ω–∏–µ 4: FILTER ‚Äî —É—Å–ª–æ–≤–Ω–∞—è –∞–≥—Ä–µ–≥–∞—Ü–∏—è
<TaskWithVariants
  title="–ó–∞–¥–∞–Ω–∏–µ 4: –£—Å–ø–µ–≤–∞–µ–º–æ—Å—Ç—å –ø–æ –∫—É—Ä—Å–∞–º"
  description="–ü–æ–¥—Å—á—ë—Ç –æ—Ü–µ–Ω–æ–∫ 5/4/3/2 —Å FILTER."
  variants={[
    <><p>–ü–æ –∫—É—Ä—Å–∞–º</p></>,
    <><p>–ü–æ –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—è–º</p></>,
    <><p>–ü–æ –≥–æ—Ä–æ–¥–∞–º —Å—Ç—É–¥–µ–Ω—Ç–æ–≤</p></>,
  ]}
>
  <details>
    <summary>–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è</summary>
    <ul>
      <li>`SELECT course_name, COUNT(*) FILTER (WHERE grade IN ('5','4')) AS ab_count`</li>
      <li>–î–æ–±–∞–≤—å—Ç–µ` COUNT(*) FILTER (WHERE grade = '3') AS c_count`</li>
      <li>–ü—Ä–æ—Ü–µ–Ω—Ç `A/B: ROUND(ab_count::NUMERIC / NULLIF(COUNT(*),0) * 100, 1)`</li>
      <li>`JOIN enrollments ‚Üí courses WHERE status = 'completed'`</li>
      <li>`GROUP BY course_id, course_name`</li>
    </ul>
  </details>
</TaskWithVariants>

## –ó–∞–¥–∞–Ω–∏–µ 5: DISTINCT ON ‚Äî –ª—É—á—à–∏–π / –ø–æ—Å–ª–µ–¥–Ω–∏–π
<TaskWithVariants
  title="–ó–∞–¥–∞–Ω–∏–µ 5: –õ—É—á—à–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Å—Ç—É–¥–µ–Ω—Ç–∞"
  description="–ù–∞–π–¥–∏—Ç–µ –ª—É—á—à–∏–π —ç–∫–∑–∞–º–µ–Ω –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å—Ç—É–¥–µ–Ω—Ç–∞."
  variants={[
    <><p>–ü–æ –ø—Ä–æ—Ü–µ–Ω—Ç—É</p></>,
    <><p>–ü–æ—Å–ª–µ–¥–Ω—è—è –∑–∞–ø–∏—Å—å –Ω–∞ –∫—É—Ä—Å</p></>,
    <><p>–ü–æ—Å–ª–µ–¥–Ω–∏–π —ç–∫–∑–∞–º–µ–Ω –∫—É—Ä—Å–∞</p></>,
  ]}
>
  <details>
    <summary>–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è</summary>
    <ul>
      <li>`SELECT DISTINCT ON (er.student_id)`</li>
      <li>–ò–º—è —Å—Ç—É–¥–µ–Ω—Ç–∞, –∫—É—Ä—Å, —Ç–∏–ø —ç–∫–∑–∞–º–µ–Ω–∞, score, max_score, –ø—Ä–æ—Ü–µ–Ω—Ç</li>
      <li>`ORDER BY er.student_id, (score::NUMERIC / max_score) DESC`</li>
      <li>`JOIN exam_results ‚Üí exams ‚Üí courses ‚Üí students`</li>
    </ul>
  </details>
  <details><summary>üí° –ü–æ–¥—Å–∫–∞–∑–∫–∞</summary><p>DISTINCT ON —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ —Å ORDER BY, –Ω–∞—á–∏–Ω–∞—é—â–∏–º—Å—è —Å —ç—Ç–∏—Ö –∂–µ –ø–æ–ª–µ–π</p></details>
</TaskWithVariants>

## –ó–∞–¥–∞–Ω–∏–µ 6: LATERAL ‚Äî —Ç–æ–ø-N –ø–æ –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—é
<TaskWithVariants
  title="–ó–∞–¥–∞–Ω–∏–µ 6: –¢–æ–ø-—Å—Ç—É–¥–µ–Ω—Ç—ã –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—è"
  description="–î–ª—è –∫–∞–∂–¥–æ–≥–æ –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—è ‚Äî –ª—É—á—à–∏–µ —Å—Ç—É–¥–µ–Ω—Ç—ã."
  variants={[
    <><p>–¢–æ–ø-2 –ø–æ —Å—Ä–µ–¥–Ω–µ–º—É –±–∞–ª–ª—É</p></>,
    <><p>–¢–æ–ø-1 —Å—Ç—É–¥–µ–Ω—Ç</p></>,
    <><p>–ü–æ—Å–ª–µ–¥–Ω–∏–µ 3 –∑–∞–ø–∏—Å–∏ –Ω–∞ –∫—É—Ä—Å</p></>,
  ]}
>
  <details>
    <summary>–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è</summary>
    <ul>
      <li>`FROM professors p CROSS JOIN LATERAL ( ‚Ä¶ ) AS top`</li>
      <li>–í –ø–æ–¥–∑–∞–ø—Ä–æ—Å–µ: `AVG(score), GROUP BY student_id, ORDER BY AVG DESC LIMIT 2`</li>
      <li>–í—ã–≤–µ—Å—Ç–∏ –§–ò–û –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—è, –§–ò–û —Å—Ç—É–¥–µ–Ω—Ç–∞, —Å—Ä–µ–¥–Ω–∏–π %</li>
      <li>–ï—Å–ª–∏ –Ω–µ—Ç —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ ‚Äî –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å LEFT JOIN LATERAL ‚Ä¶ ON TRUE</li>
    </ul>
  </details>
</TaskWithVariants>

## –ó–∞–¥–∞–Ω–∏–µ 7: CTE ‚Äî –º–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤—ã–π –æ—Ç—á—ë—Ç
<TaskWithVariants
  title="–ó–∞–¥–∞–Ω–∏–µ 7: –û—Ç—á—ë—Ç –ø–æ –∫—É—Ä—Å–∞–º"
  description="–°–æ–±–µ—Ä–∏—Ç–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø–æ –∫—É—Ä—Å–∞–º —Å –ø–æ–º–æ—â—å—é CTE."
  variants={[
    <><p>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ + A/B</p></>,
    <><p>–°—Ä–µ–¥–Ω–∏–π % –ø–æ —ç–∫–∑–∞–º–µ–Ω–∞–º</p></>,
    <><p>–¢–æ–ø-5 —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ –ø–æ –æ—Ü–µ–Ω–∫–∞–º</p></>,
  ]}
>
  <details>
    <summary>–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è</summary>
    <ul>
      <li>`WITH course_stats AS (SELECT course_id, COUNT(DISTINCT student_id) ‚Ä¶)`</li>
      <li>`WITH exam_stats AS (AVG(score / max_score * 100) ‚Ä¶)`</li>
      <li>`SELECT course_name, enrolled_count, ab_count, ab_rate, avg_percentage`</li>
      <li>`LEFT JOIN course_stats –∏ exam_stats`</li>
      <li>`ORDER BY ab_rate DESC NULLS LAST`</li>
    </ul>
  </details>
</TaskWithVariants>

## –ó–∞–¥–∞–Ω–∏–µ 8: UNION / INTERSECT / EXCEPT
<TaskWithVariants
  title="–ó–∞–¥–∞–Ω–∏–µ 8: –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –∏ —Ä–∞–∑–Ω–æ—Å—Ç—å"
  description="–†–∞–±–æ—Ç–∞ —Å –Ω–∞–±–æ—Ä–∞–º–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤."
  variants={[
    <><p>–í—Å–µ –ª—é–¥–∏ ‚Äî —Å—Ç—É–¥–µ–Ω—Ç—ã + –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª–∏</p></>,
    <><p>–°—Ç—É–¥–µ–Ω—Ç—ã –Ω–∞ –ò–Ω—Ñ–æ—Ä–º–∞—Ç–∏–∫–µ –∏ –ú–∞—Ç–µ–º–∞—Ç–∏–∫–µ</p></>,
    <><p>–°—Ç—É–¥–µ–Ω—Ç—ã –±–µ–∑ —ç–∫–∑–∞–º–µ–Ω–æ–≤</p></>,
  ]}
>
  <details>
    <summary>–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è</summary>
    <ul>
      <li>UNION: `SELECT first_name, last_name, 'Student' FROM students UNION SELECT ‚Ä¶ FROM professors``</li>
      <li>INTERSECT: —Å—Ç—É–¥–µ–Ω—Ç—ã, –∑–∞–ø–∏—Å–∞–Ω–Ω—ã–µ –∏ –Ω–∞ CS*, –∏ –Ω–∞ MATH*</li>
      <li>EXCEPT: —Å—Ç—É–¥–µ–Ω—Ç—ã major='–ò–Ω—Ñ–æ—Ä–º–∞—Ç–∏–∫–∞' –∫—Ä–æ–º–µ —Ç–µ—Ö, –∫—Ç–æ –∑–∞–ø–∏—Å–∞–Ω –Ω–∞ CS*</li>
    </ul>
  </details>
</TaskWithVariants>

## –ó–∞–¥–∞–Ω–∏–µ 9: –ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –æ—Ç—á—ë—Ç
<TaskWithVariants
  title="–ó–∞–¥–∞–Ω–∏–µ 9: –ü–æ–ª–Ω—ã–π –æ—Ç—á—ë—Ç –ø–æ —É—Å–ø–µ–≤–∞–µ–º–æ—Å—Ç–∏"
  description="–°–æ–±–µ—Ä–∏—Ç–µ —Å–ª–æ–∂–Ω—ã–π –æ—Ç—á—ë—Ç –ø–æ –≤—Å–µ–º –∫—É—Ä—Å–∞–º."
  variants={[
    <><p>–° —Ç–æ–ø-—Å—Ç—É–¥–µ–Ω—Ç–æ–º –ø–æ –∫—É—Ä—Å—É</p></>,
    <><p>–° –ø—Ä–æ—Ü–µ–Ω—Ç–æ–º A/B –∏ —Å—Ä–µ–¥–Ω–∏–º —ç–∫–∑–∞–º–µ–Ω–æ–º</p></>,
    <><p>–° –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –æ—Ç–ª–∏—á–Ω–∏–∫–æ–≤</p></>,
  ]}
>
  <details>
    <summary>–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è</summary>
    <ul>
      <li>–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ 2‚Äì3 CTE</li>
      <li>`course_name, professor, enrolled_count, ab_rate, avg_exam_%`</li>
      <li>–î–æ–±–∞–≤—å—Ç–µ LATERAL –∏–ª–∏ –æ–∫–æ–Ω–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é –¥–ª—è —Ç–æ–ø-1 —Å—Ç—É–¥–µ–Ω—Ç–∞</li>
      <li>–°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞: –ø–æ ab_rate DESC, –ø–æ—Ç–æ–º –ø–æ avg_exam DESC</li>
    </ul>
  </details>
  <details><summary>üí° –ü–æ–¥—Å–∫–∞–∑–∫–∞</summary><p>COALESCE –¥–ª—è —Å–ª—É—á–∞–µ–≤, –∫–æ–≥–¥–∞ –Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö</p></details>
</TaskWithVariants>

## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã
–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –≤—Å–µ—Ö –∑–∞–¥–∞–Ω–∏–π:
- –ó–∞–ø—É—Å—Ç–∏—Ç–µ `EXPLAIN ANALYZE` –Ω–∞ 2‚Äì3 —Å–∞–º—ã—Ö —Å–ª–æ–∂–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–∞
- –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –¥–æ–±–∞–≤–∏—Ç—å LIMIT 10 / OFFSET 20
- –ü–æ—ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ —Å ORDER BY –∏ NULLS FIRST/LAST

:::tip –°–æ–≤–µ—Ç
–ï—Å–ª–∏ –∑–∞–ø—Ä–æ—Å —Å–ª–∏—à–∫–æ–º –º–µ–¥–ª–µ–Ω–Ω—ã–π ‚Äî –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –∏–Ω–¥–µ–∫—Å—ã –∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ EXPLAIN!
:::
